import{$ as _t,Aa as Pt,B as Ht,Ba as In,Bb as v,Ca as po,Cb as wt,D as Ze,Da as fo,Db as Ce,E as ao,Ea as G,F as Ee,Fa as M,Fb as _o,G as lo,Ga as q,H as ee,Ha as at,I as bi,Ia as Ft,K as W,Ka as Vt,Kb as Ge,La as k,Ma as Hn,Mb as Co,Na as Le,O as h,Oa as je,Pa as F,Q as O,Qa as L,R as re,Ra as U,T as A,Ua as be,V as Qt,Va as ze,W as kn,Xa as J,Y as Q,Ya as x,Z as K,Za as Rn,_ as D,_a as Pn,a as Ot,aa as On,b as Ve,ba as Ae,ca as Be,d as ro,da as co,db as $t,e as Mn,ea as Ct,eb as Ke,f as Ut,fa as H,fb as Je,g as Se,ga as se,ha as uo,i as Dt,j as Ue,ka as ho,m as I,ma as Ti,na as w,nb as Fn,o as $e,ob as ae,pa as Rt,q as ue,qb as Ei,rb as mo,s as de,sb as go,t as so,tb as xo,ua as Dn,ub as yo,xb as vo,y as Zt,ya as S,z as It,za as Qe}from"./chunk-VLX6VUPD.js";import{a as Yt,b as oo}from"./chunk-P2VZOJAX.js";var zi=(()=>{class e{constructor(){this.templateRef=h(Rt)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["ng-template","edge",""]],standalone:!0})}}return e})(),Ni=(()=>{class e{constructor(){this.templateRef=h(Rt)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["ng-template","connection",""]],standalone:!0})}}return e})(),Mi=(()=>{class e{constructor(){this.templateRef=h(Rt)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["ng-template","edgeLabelHtml",""]],standalone:!0})}}return e})(),ki=(()=>{class e{constructor(){this.templateRef=h(Rt)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["ng-template","nodeHtml",""]],standalone:!0})}}return e})(),Oi=(()=>{class e{constructor(){this.templateRef=h(Rt)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["ng-template","groupNode",""]],standalone:!0})}}return e})();function he(e){e||(kn(he),e=h(Be));let i=new Ot(t=>e.onDestroy(t.next.bind(t)));return t=>t.pipe(lo(i))}var Di=class{constructor(i){this.source=i,this.destroyed=!1,this.destroyRef=h(Be),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}subscribe(i){if(this.destroyed)throw new bi(953,!1);let t=this.source.pipe(he(this.destroyRef)).subscribe({next:n=>i(n)});return{unsubscribe:()=>t.unsubscribe()}}};function B(e,i){return new Di(e)}function X(e,i){!i?.injector&&kn(X);let t=i?.injector??h(Ae),n=new ro(1),o=Ce(()=>{let r;try{r=e()}catch(s){wt(()=>n.error(s));return}wt(()=>n.next(r))},{injector:t,manualCleanup:!0});return t.get(Be).onDestroy(()=>{o.destroy(),n.complete()}),n.asObservable()}function Ne(e,i){let t=!i?.manualCleanup;t&&!i?.injector&&kn(Ne);let n=t?i?.injector?.get(Be)??h(Be):null,o;i?.requireSync?o=S({kind:0}):o=S({kind:1,value:i?.initialValue});let r=e.subscribe({next:s=>o.set({kind:1,value:s}),error:s=>{if(i?.rejectErrors)throw s;o.set({kind:2,error:s})}});return n?.onDestroy(r.unsubscribe.bind(r)),v(()=>{let s=o();switch(s.kind){case 1:return s.value;case 2:throw s.error;case 0:throw new bi(601,"`toSignal()` called with `requireSync` but `Observable` did not emit synchronously.")}})}var Kt=(()=>{class e{constructor(){this._event$=new Ve,this.event$=this._event$.asObservable()}pushEvent(t){this._event$.next(t)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var St=(()=>{class e{constructor(){this.model=S(null)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var Vn=(()=>{class e{constructor(){this.eventBus=h(Kt),this.nodeService=h(St),this.destroyRef=h(Be),this.selected=this.nodeService.model().selected,this.data=S(void 0)}ngOnInit(){this.trackEvents().pipe(he(this.destroyRef)).subscribe()}trackEvents(){let t=Object.getOwnPropertyNames(this),n=new Map;for(let o of t){let r=this[o];r instanceof uo&&n.set(r,o),r instanceof co&&n.set(Ps(r),o)}return ue(...Array.from(n.keys()).map(o=>o.pipe(ee(r=>{this.eventBus.pushEvent({nodeId:this.nodeService.model()?.node.id??"",eventName:n.get(o),eventPayload:r})}))))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e})}}return e})();function Ps(e){return new Ot(i=>{let t=e.subscribe(n=>{i.next(n)});return()=>{t.unsubscribe()}})}var $n=(()=>{class e extends Vn{constructor(){super(...arguments),this.node=H.required()}ngOnInit(){this.node().data&&this.data.set(this.node().data),super.ngOnInit()}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=On(e)))(o||e)}})()}static{this.\u0275dir=A({type:e,inputs:{node:[O.SignalBased,"node"]},features:[In]})}}return e})();var wo=(()=>{class e extends Vn{constructor(){super(...arguments),this.node=H.required()}ngOnInit(){let t=this.node().data;t&&(this.data=t),super.ngOnInit()}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=On(e)))(o||e)}})()}static{this.\u0275dir=A({type:e,inputs:{node:[O.SignalBased,"node"]},features:[In]})}}return e})();function et(e){return typeof e.point=="function"}function rd(e){return $n.isPrototypeOf(e.type)}function sd(e){return e.type==="default"}Dt();var lt=(()=>{class e{constructor(){this.host=h(se).nativeElement,this.initialTouch$=new Ve,this.prevTouchEvent=null,this.mouseMovement$=$e(this.host,"mousemove").pipe(I(t=>({x:t.clientX,y:t.clientY,movementX:t.movementX,movementY:t.movementY,target:t.target,originalEvent:t})),Ue(Ut),Ht()),this.touchMovement$=ue(this.initialTouch$,$e(this.host,"touchmove")).pipe(ee(t=>t.preventDefault()),I(t=>{let n=t.touches[0]?.clientX??0,o=t.touches[0]?.clientY??0,r=this.prevTouchEvent?t.touches[0].pageX-this.prevTouchEvent.touches[0].pageX:0,s=this.prevTouchEvent?t.touches[0].pageY-this.prevTouchEvent.touches[0].pageY:0,a=document.elementFromPoint(n,o);return{x:n,y:o,movementX:r,movementY:s,target:a,originalEvent:t}}),ee(t=>this.prevTouchEvent=t.originalEvent),Ue(Ut),Ht()),this.pointerMovement$=ue(this.mouseMovement$,this.touchMovement$),this.touchEnd$=$e(this.host,"touchend").pipe(I(t=>{let n=t.changedTouches[0]?.clientX??0,o=t.changedTouches[0]?.clientY??0,r=document.elementFromPoint(n,o);return{x:n,y:o,target:r,originalEvent:t}}),ee(()=>this.prevTouchEvent=null),Ht()),this.mouseUp$=$e(this.host,"mouseup").pipe(I(t=>{let n=t.clientX,o=t.clientY,r=t.target;return{x:n,y:o,target:r,originalEvent:t}}),Ht()),this.documentPointerEnd$=ue($e(document,"mouseup"),$e(document,"touchend")).pipe(Ht())}setInitialTouch(t){this.initialTouch$.next(t)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["svg","rootPointer",""]],standalone:!0})}}return e})();function An(e){if(e.length===0)return{x:0,y:0,width:0,height:0};let i={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(t=>{let n=Fs(t);i=$s(i,n)}),Vs(i)}function Fs(e){return{x:e.point().x,y:e.point().y,x2:e.point().x+e.size().width,y2:e.point().y+e.size().height}}function Vs({x:e,y:i,x2:t,y2:n}){return{x:e,y:i,width:t-e,height:n-i}}function $s(e,i){return{x:Math.min(e.x,i.x),y:Math.min(e.y,i.y),x2:Math.max(e.x2,i.x2),y2:Math.max(e.y2,i.y2)}}var At=class{constructor(i){this.settings=i,this.curve=i.curve??"bezier",this.type=i.type??"default",this.mode=i.mode??"strict";let t=this.getValidators(i);this.validator=n=>t.every(o=>o(n))}getValidators(i){let t=[];return t.push(As),this.mode==="loose"&&t.push(Bs),i.validator&&t.push(i.validator),t}},As=e=>e.source!==e.target,Bs=e=>e.sourceHandle!==void 0&&e.targetHandle!==void 0;function tt(e){return e.split("").reduce((i,t)=>(i=(i<<5)-i+t.charCodeAt(0),i&i),0)}var pe=(()=>{class e{constructor(){this.nodes=S([],{equal:(t,n)=>!t.length&&!n.length?!0:t===n}),this.edges=S([],{equal:(t,n)=>!t.length&&!n.length?!0:t===n}),this.validEdges=v(()=>{let t=this.nodes();return this.edges().filter(n=>t.includes(n.source())&&t.includes(n.target()))}),this.connection=S(new At({})),this.markers=v(()=>{let t=new Map;this.validEdges().forEach(o=>{if(o.edge.markers?.start){let r=tt(JSON.stringify(o.edge.markers.start));t.set(r,o.edge.markers.start)}if(o.edge.markers?.end){let r=tt(JSON.stringify(o.edge.markers.end));t.set(r,o.edge.markers.end)}});let n=this.connection().settings.marker;if(n){let o=tt(JSON.stringify(n));t.set(o,n)}return t}),this.entities=v(()=>[...this.nodes(),...this.edges()]),this.minimap=S(null)}getNode(t){return this.nodes().find(({node:n})=>n.id===t)}getDetachedEdges(){return this.edges().filter(t=>t.detached())}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();function So(e,i,t,n,o,r){let s=i/(e.width*(1+r)),a=t/(e.height*(1+r)),l=Math.min(s,a),u=Ls(l,n,o),c=e.x+e.width/2,m=e.y+e.height/2,p=i/2-c*u,y=t/2-m*u;return{x:p,y,zoom:u}}function Ls(e,i=0,t=1){return Math.min(Math.max(e,i),t)}var ye=(()=>{class e{constructor(){this.entitiesSelectable=S(!0),this.view=S([400,400]),this.computedFlowWidth=S(0),this.computedFlowHeight=S(0),this.minZoom=S(.5),this.maxZoom=S(3),this.background=S({type:"solid",color:"#fff"})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var nt=(()=>{class e{constructor(){this.entitiesService=h(pe),this.flowSettingsService=h(ye),this.writableViewport=S({changeType:"initial",state:e.getDefaultViewport(),duration:0}),this.readableViewport=S(e.getDefaultViewport())}static getDefaultViewport(){return{zoom:1,x:0,y:0}}fitView(t={padding:.1,duration:0,nodes:[]}){let n=this.getBoundsNodes(t.nodes??[]),o=So(An(n),this.flowSettingsService.computedFlowWidth(),this.flowSettingsService.computedFlowHeight(),this.flowSettingsService.minZoom(),this.flowSettingsService.maxZoom(),t.padding??.1),r=t.duration??0;this.writableViewport.set({changeType:"absolute",state:o,duration:r})}getBoundsNodes(t){return t?.length?t.map(n=>this.entitiesService.nodes().find(({node:o})=>o.id===n)).filter(n=>!!n):this.entitiesService.nodes()}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var Bt=e=>Math.round(e*100)/100;function it(e,i,t){let n=t.value;return t.value=function(...o){queueMicrotask(()=>{n?.apply(this,o)})},t}var ct=(()=>{class e{constructor(){this.element=h(se).nativeElement}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["svg","rootSvgRef",""]],standalone:!0})}}return e})();var ut=(()=>{class e{constructor(){this.pointerMovementDirective=h(lt),this.rootSvg=h(ct).element,this.host=h(se).nativeElement,this.svgCurrentSpacePoint=v(()=>{let t=this.pointerMovement();return t?this.documentPointToFlowPoint({x:t.x,y:t.y}):{x:0,y:0}}),this.pointerMovement=Ne(this.pointerMovementDirective.pointerMovement$)}documentPointToFlowPoint(t){let n=this.rootSvg.createSVGPoint();return n.x=t.x,n.y=t.y,n.matrixTransform(this.host.getScreenCTM().inverse())}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["g","spacePointContext",""]],standalone:!0})}}return e})();var Bn=(()=>{class e{constructor(){this.hostElement=h(se).nativeElement,this.pointerMovementDirective=h(lt),this.pointerOver=Ct(),this.pointerOut=Ct(),this.pointerStart=Ct(),this.pointerEnd=Ct(),this.wasPointerOver=!1,this.touchEnd=this.pointerMovementDirective.touchEnd$.pipe(de(({target:t})=>t===this.hostElement),ee(({originalEvent:t})=>this.pointerEnd.emit(t)),he()).subscribe(),this.touchOverOut=this.pointerMovementDirective.touchMovement$.pipe(ee(({target:t,originalEvent:n})=>{this.handleTouchOverAndOut(t,n)}),he()).subscribe()}onPointerStart(t){this.pointerStart.emit(t),t instanceof TouchEvent&&this.pointerMovementDirective.setInitialTouch(t)}onPointerEnd(t){this.pointerEnd.emit(t)}onMouseOver(t){this.pointerOver.emit(t)}onMouseOut(t){this.pointerOut.emit(t)}handleTouchOverAndOut(t,n){t===this.hostElement?(this.pointerOver.emit(n),this.wasPointerOver=!0):(this.wasPointerOver&&this.pointerOut.emit(n),this.wasPointerOver=!1)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["","pointerStart",""],["","pointerEnd",""],["","pointerOver",""],["","pointerOut",""]],hostBindings:function(n,o){n&1&&J("mousedown",function(s){return o.onPointerStart(s)})("touchstart",function(s){return o.onPointerStart(s)})("mouseup",function(s){return o.onPointerEnd(s)})("mouseover",function(s){return o.onMouseOver(s)})("mouseout",function(s){return o.onMouseOut(s)})},outputs:{pointerOver:"pointerOver",pointerOut:"pointerOut",pointerStart:"pointerStart",pointerEnd:"pointerEnd"},standalone:!0})}}return e})();var js=["resizer"],Gs=["resizable",""],qs=["*"];function Ws(e,i){if(e&1){let t=ze();D(),F(0,"g")(1,"line",1),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("top",o))}),L(),F(2,"line",2),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("left",o))}),L(),F(3,"line",3),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("bottom",o))}),L(),F(4,"line",4),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("right",o))}),L(),F(5,"rect",5),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("top-left",o))}),L(),F(6,"rect",6),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("top-right",o))}),L(),F(7,"rect",7),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("bottom-left",o))}),L(),F(8,"rect",8),J("pointerStart",function(o){Q(t);let r=x();return K(r.startResize("bottom-right",o))}),L()()}if(e&2){let t=x();w(),M("x1",t.lineGap)("y1",-t.gap())("x2",t.model.size().width-t.lineGap)("y2",-t.gap())("stroke",t.resizerColor()),w(),M("x1",-t.gap())("y1",t.lineGap)("x2",-t.gap())("y2",t.model.size().height-t.lineGap)("stroke",t.resizerColor()),w(),M("x1",t.lineGap)("y1",t.model.size().height+t.gap())("x2",t.model.size().width-t.lineGap)("y2",t.model.size().height+t.gap())("stroke",t.resizerColor()),w(),M("x1",t.model.size().width+t.gap())("y1",t.lineGap)("x2",t.model.size().width+t.gap())("y2",t.model.size().height-t.lineGap)("stroke",t.resizerColor()),w(),M("x",-(t.handleSize/2)-t.gap())("y",-(t.handleSize/2)-t.gap())("width",t.handleSize)("height",t.handleSize)("fill",t.resizerColor()),w(),M("x",t.model.size().width-t.handleSize/2+t.gap())("y",-(t.handleSize/2)-t.gap())("width",t.handleSize)("height",t.handleSize)("fill",t.resizerColor()),w(),M("x",-(t.handleSize/2)-t.gap())("y",t.model.size().height-t.handleSize/2+t.gap())("width",t.handleSize)("height",t.handleSize)("fill",t.resizerColor()),w(),M("x",t.model.size().width-t.handleSize/2+t.gap())("y",t.model.size().height-t.handleSize/2+t.gap())("width",t.handleSize)("height",t.handleSize)("fill",t.resizerColor())}}var bo=(()=>{class e{get model(){return this.nodeAccessor.model()}constructor(){this.nodeAccessor=h(St),this.rootPointer=h(lt),this.viewportService=h(nt),this.spacePointContext=h(ut),this.hostRef=h(se),this.resizable=H(),this.resizerColor=H("#2e414c"),this.gap=H(1.5),this.resizer=Qe.required("resizer"),this.lineGap=3,this.handleSize=6,this.resizeSide=null,this.zoom=v(()=>this.viewportService.readableViewport().zoom??0),this.minWidth=0,this.minHeight=0,this.resizeOnGlobalMouseMove=this.rootPointer.pointerMovement$.pipe(de(()=>this.resizeSide!==null),de(t=>t.movementX!==0||t.movementY!==0),ee(t=>this.resize(t)),he()).subscribe(),this.endResizeOnGlobalMouseUp=this.rootPointer.documentPointerEnd$.pipe(ee(()=>this.endResize()),he()).subscribe(),Ce(()=>{let t=this.resizable();typeof t=="boolean"?this.model.resizable.set(t):this.model.resizable.set(!0)},{allowSignalWrites:!0})}ngOnInit(){this.model.resizerTemplate.set(this.resizer())}ngAfterViewInit(){this.minWidth=+getComputedStyle(this.hostRef.nativeElement).minWidth.replace("px","")||0,this.minHeight=+getComputedStyle(this.hostRef.nativeElement).minHeight.replace("px","")||0}startResize(t,n){n.stopPropagation(),this.resizeSide=t,this.model.resizing.set(!0)}resize(t){if(!this.resizeSide||this.isResizeConstrained(t))return;let n=Xs(t.movementX,t.movementY,this.zoom()),{x:o,y:r,width:s,height:a}=Us(Ys(this.resizeSide,this.model,n),this.model,this.resizeSide,this.minWidth,this.minHeight);this.model.setPoint({x:o,y:r},!1),this.model.size.set({width:s,height:a})}endResize(){this.resizeSide=null,this.model.resizing.set(!1)}isResizeConstrained({x:t,y:n,movementX:o,movementY:r}){let s=this.spacePointContext.documentPointToFlowPoint({x:t,y:n});return!!(this.resizeSide?.includes("right")&&(o>0&&s.x<this.model.point().x+this.model.size().width||o<0&&s.x>this.model.point().x+this.model.size().width)||this.resizeSide?.includes("left")&&(o<0&&s.x>this.model.point().x||o>0&&s.x<this.model.point().x)||this.resizeSide?.includes("bottom")&&(r>0&&s.y<this.model.point().y+this.model.size().height||r<0&&s.y>this.model.point().y+this.model.size().height)||this.resizeSide?.includes("top")&&(r<0&&s.y>this.model.point().y||r>0&&s.y<this.model.point().y))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["","resizable",""]],viewQuery:function(n,o){n&1&&Ke(o.resizer,js,5),n&2&&Je()},inputs:{resizable:[O.SignalBased,"resizable"],resizerColor:[O.SignalBased,"resizerColor"],gap:[O.SignalBased,"gap"]},standalone:!0,features:[ae],attrs:Gs,ngContentSelectors:qs,decls:3,vars:0,consts:[["resizer",""],["stroke-width","2",1,"top",3,"pointerStart"],["stroke-width","2",1,"left",3,"pointerStart"],["stroke-width","2",1,"bottom",3,"pointerStart"],["stroke-width","2",1,"right",3,"pointerStart"],[1,"top-left",3,"pointerStart"],[1,"top-right",3,"pointerStart"],[1,"bottom-left",3,"pointerStart"],[1,"bottom-right",3,"pointerStart"]],template:function(n,o){n&1&&(Rn(),G(0,Ws,9,40,"ng-template",null,0,vo),Pn(2))},dependencies:[Bn],styles:[".top[_ngcontent-%COMP%]{cursor:n-resize}.left[_ngcontent-%COMP%]{cursor:w-resize}.right[_ngcontent-%COMP%]{cursor:e-resize}.bottom[_ngcontent-%COMP%]{cursor:s-resize}.top-left[_ngcontent-%COMP%]{cursor:nw-resize}.top-right[_ngcontent-%COMP%]{cursor:ne-resize}.bottom-left[_ngcontent-%COMP%]{cursor:sw-resize}.bottom-right[_ngcontent-%COMP%]{cursor:se-resize}"]})}}return Se([it],e.prototype,"ngAfterViewInit",null),e})();function Xs(e,i,t){return{offsetX:Bt(e/t),offsetY:Bt(i/t)}}function Ys(e,i,t){let{offsetX:n,offsetY:o}=t,{x:r,y:s}=i.point(),{width:a,height:l}=i.size();switch(e){case"left":return{x:r+n,y:s,width:a-n,height:l};case"right":return{x:r,y:s,width:a+n,height:l};case"top":return{x:r,y:s+o,width:a,height:l-o};case"bottom":return{x:r,y:s,width:a,height:l+o};case"top-left":return{x:r+n,y:s+o,width:a-n,height:l-o};case"top-right":return{x:r,y:s+o,width:a+n,height:l-o};case"bottom-left":return{x:r+n,y:s,width:a-n,height:l+o};case"bottom-right":return{x:r,y:s,width:a+n,height:l+o}}}function Us(e,i,t,n,o){let{x:r,y:s,width:a,height:l}=e;a=Math.max(a,0),l=Math.max(l,0),a=Math.max(n,a),l=Math.max(o,l),r=Math.min(r,i.point().x+i.size().width-n),s=Math.min(s,i.point().y+i.size().height-o);let u=i.parent();u&&(r=Math.max(r,0),s=Math.max(s,0),r===0&&(a=i.point().x+i.size().width),s===0&&(l=i.point().y+i.size().height),a=Math.min(a,u.size().width-i.point().x),l=Math.min(l,u.size().height-i.point().y));let c=An(i.children());return c&&(t.includes("left")&&(r=Math.min(r,i.point().x+i.size().width-(c.x+c.width)),a=Math.max(a,c.x+c.width)),t.includes("right")&&(a=Math.max(a,c.x+c.width)),t.includes("bottom")&&(l=Math.max(l,c.y+c.height)),t.includes("top")&&(s=Math.min(s,i.point().y+i.size().height-(c.y+c.height)),l=Math.max(l,c.y+c.height))),{x:r,y:s,width:a,height:l}}Dt();Dt();var Jt=(()=>{class e{constructor(){this.node=S(null)}createHandle(t){let n=this.node();n&&n.handles.update(o=>[...o,t])}destroyHandle(t){let n=this.node();n&&n.handles.update(o=>o.filter(r=>r!==t))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return Se([it],e.prototype,"createHandle",null),e})();var Ln=class{constructor(i,t){this.rawHandle=i,this.parentNode=t,this.strokeWidth=2,this.size=S({width:10+2*this.strokeWidth,height:10+2*this.strokeWidth}),this.offset=v(()=>{switch(this.rawHandle.position){case"left":return{x:0,y:this.parentPosition().y+this.parentSize().height/2};case"right":return{x:this.parentNode.size().width,y:this.parentPosition().y+this.parentSize().height/2};case"top":return{x:this.parentPosition().x+this.parentSize().width/2,y:0};case"bottom":return{x:this.parentPosition().x+this.parentSize().width/2,y:this.parentNode.size().height}}}),this.sizeOffset=v(()=>{switch(this.rawHandle.position){case"left":return{x:-(this.size().width/2),y:0};case"right":return{x:this.size().width/2,y:0};case"top":return{x:0,y:-(this.size().height/2)};case"bottom":return{x:0,y:this.size().height/2}}}),this.pointAbsolute=v(()=>({x:this.parentNode.globalPoint().x+this.offset().x+this.sizeOffset().x,y:this.parentNode.globalPoint().y+this.offset().y+this.sizeOffset().y})),this.state=S("idle"),this.updateParentSizeAndPosition$=new Ve,this.parentSize=Ne(this.updateParentSizeAndPosition$.pipe(I(()=>this.getParentSize())),{initialValue:{width:0,height:0}}),this.parentPosition=Ne(this.updateParentSizeAndPosition$.pipe(I(()=>({x:this.parentReference instanceof HTMLElement?this.parentReference.offsetLeft:0,y:this.parentReference instanceof HTMLElement?this.parentReference.offsetTop:0}))),{initialValue:{x:0,y:0}}),this.parentReference=this.rawHandle.parentReference,this.template=this.rawHandle.template,this.templateContext={$implicit:{point:this.offset,state:this.state,node:this.parentNode.node}}}updateParent(){this.updateParentSizeAndPosition$.next()}getParentSize(){return this.parentReference instanceof HTMLElement?{width:this.parentReference.offsetWidth,height:this.parentReference.offsetHeight}:this.parentReference instanceof SVGGraphicsElement?this.parentReference.getBBox():{width:0,height:0}}};function en(e,i,t){let n=t.value;return t.value=function(...o){if(Zs(this))return Qt(this.injector,()=>n.apply(this,o));throw new Error("Class that contains decorated method must extends WithInjectorDirective class")},t}var Zs=e=>"injector"in e&&"get"in e.injector;var To=(()=>{class e{constructor(){this.injector=h(Ae),this.handleService=h(Jt),this.element=h(se).nativeElement,this.destroyRef=h(Be),this.position=H.required(),this.type=H.required(),this.id=H(),this.template=H()}ngOnInit(){let t=this.handleService.node();t&&(this.model=new Ln({position:this.position(),type:this.type(),id:this.id(),parentReference:this.element.parentElement,template:this.template()},t),this.handleService.createHandle(this.model),requestAnimationFrame(()=>this.model.updateParent()),this.destroyRef.onDestroy(()=>this.handleService.destroyHandle(this.model)))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["handle"]],inputs:{position:[O.SignalBased,"position"],type:[O.SignalBased,"type"],id:[O.SignalBased,"id"],template:[O.SignalBased,"template"]},standalone:!0,features:[ae],decls:0,vars:0,template:function(n,o){},encapsulation:2,changeDetection:0})}}return Se([en],e.prototype,"ngOnInit",null),e})();var jn="http://www.w3.org/1999/xhtml",Ii={svg:"http://www.w3.org/2000/svg",xhtml:jn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ot(e){var i=e+="",t=i.indexOf(":");return t>=0&&(i=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),Ii.hasOwnProperty(i)?{space:Ii[i],local:e}:e}function Qs(e){return function(){var i=this.ownerDocument,t=this.namespaceURI;return t===jn&&i.documentElement.namespaceURI===jn?i.createElement(e):i.createElementNS(t,e)}}function Ks(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Gn(e){var i=ot(e);return(i.local?Ks:Qs)(i)}function Js(){}function bt(e){return e==null?Js:function(){return this.querySelector(e)}}function Eo(e){typeof e!="function"&&(e=bt(e));for(var i=this._groups,t=i.length,n=new Array(t),o=0;o<t;++o)for(var r=i[o],s=r.length,a=n[o]=new Array(s),l,u,c=0;c<s;++c)(l=r[c])&&(u=e.call(l,l.__data__,c,r))&&("__data__"in l&&(u.__data__=l.__data__),a[c]=u);return new te(n,this._parents)}function Hi(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ea(){return[]}function tn(e){return e==null?ea:function(){return this.querySelectorAll(e)}}function ta(e){return function(){return Hi(e.apply(this,arguments))}}function zo(e){typeof e=="function"?e=ta(e):e=tn(e);for(var i=this._groups,t=i.length,n=[],o=[],r=0;r<t;++r)for(var s=i[r],a=s.length,l,u=0;u<a;++u)(l=s[u])&&(n.push(e.call(l,l.__data__,u,s)),o.push(l));return new te(n,o)}function nn(e){return function(){return this.matches(e)}}function qn(e){return function(i){return i.matches(e)}}var na=Array.prototype.find;function ia(e){return function(){return na.call(this.children,e)}}function oa(){return this.firstElementChild}function No(e){return this.select(e==null?oa:ia(typeof e=="function"?e:qn(e)))}var ra=Array.prototype.filter;function sa(){return Array.from(this.children)}function aa(e){return function(){return ra.call(this.children,e)}}function Mo(e){return this.selectAll(e==null?sa:aa(typeof e=="function"?e:qn(e)))}function ko(e){typeof e!="function"&&(e=nn(e));for(var i=this._groups,t=i.length,n=new Array(t),o=0;o<t;++o)for(var r=i[o],s=r.length,a=n[o]=[],l,u=0;u<s;++u)(l=r[u])&&e.call(l,l.__data__,u,r)&&a.push(l);return new te(n,this._parents)}function Wn(e){return new Array(e.length)}function Oo(){return new te(this._enter||this._groups.map(Wn),this._parents)}function on(e,i){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=i}on.prototype={constructor:on,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,i){return this._parent.insertBefore(e,i)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Do(e){return function(){return e}}function la(e,i,t,n,o,r){for(var s=0,a,l=i.length,u=r.length;s<u;++s)(a=i[s])?(a.__data__=r[s],n[s]=a):t[s]=new on(e,r[s]);for(;s<l;++s)(a=i[s])&&(o[s]=a)}function ca(e,i,t,n,o,r,s){var a,l,u=new Map,c=i.length,m=r.length,p=new Array(c),y;for(a=0;a<c;++a)(l=i[a])&&(p[a]=y=s.call(l,l.__data__,a,i)+"",u.has(y)?o[a]=l:u.set(y,l));for(a=0;a<m;++a)y=s.call(e,r[a],a,r)+"",(l=u.get(y))?(n[a]=l,l.__data__=r[a],u.delete(y)):t[a]=new on(e,r[a]);for(a=0;a<c;++a)(l=i[a])&&u.get(p[a])===l&&(o[a]=l)}function ua(e){return e.__data__}function Io(e,i){if(!arguments.length)return Array.from(this,ua);var t=i?ca:la,n=this._parents,o=this._groups;typeof e!="function"&&(e=Do(e));for(var r=o.length,s=new Array(r),a=new Array(r),l=new Array(r),u=0;u<r;++u){var c=n[u],m=o[u],p=m.length,y=da(e.call(c,c&&c.__data__,u,n)),P=y.length,$=a[u]=new Array(P),Z=s[u]=new Array(P),b=l[u]=new Array(p);t(c,m,$,Z,b,y,i);for(var me=0,ge=0,g,E;me<P;++me)if(g=$[me]){for(me>=ge&&(ge=me+1);!(E=Z[ge])&&++ge<P;);g._next=E||null}}return s=new te(s,n),s._enter=a,s._exit=l,s}function da(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ho(){return new te(this._exit||this._groups.map(Wn),this._parents)}function Ro(e,i,t){var n=this.enter(),o=this,r=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),i!=null&&(o=i(o),o&&(o=o.selection())),t==null?r.remove():t(r),n&&o?n.merge(o).order():o}function Po(e){for(var i=e.selection?e.selection():e,t=this._groups,n=i._groups,o=t.length,r=n.length,s=Math.min(o,r),a=new Array(o),l=0;l<s;++l)for(var u=t[l],c=n[l],m=u.length,p=a[l]=new Array(m),y,P=0;P<m;++P)(y=u[P]||c[P])&&(p[P]=y);for(;l<o;++l)a[l]=t[l];return new te(a,this._parents)}function Fo(){for(var e=this._groups,i=-1,t=e.length;++i<t;)for(var n=e[i],o=n.length-1,r=n[o],s;--o>=0;)(s=n[o])&&(r&&s.compareDocumentPosition(r)^4&&r.parentNode.insertBefore(s,r),r=s);return this}function Vo(e){e||(e=ha);function i(m,p){return m&&p?e(m.__data__,p.__data__):!m-!p}for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r){for(var s=t[r],a=s.length,l=o[r]=new Array(a),u,c=0;c<a;++c)(u=s[c])&&(l[c]=u);l.sort(i)}return new te(o,this._parents).order()}function ha(e,i){return e<i?-1:e>i?1:e>=i?0:NaN}function $o(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Ao(){return Array.from(this)}function Bo(){for(var e=this._groups,i=0,t=e.length;i<t;++i)for(var n=e[i],o=0,r=n.length;o<r;++o){var s=n[o];if(s)return s}return null}function Lo(){let e=0;for(let i of this)++e;return e}function jo(){return!this.node()}function Go(e){for(var i=this._groups,t=0,n=i.length;t<n;++t)for(var o=i[t],r=0,s=o.length,a;r<s;++r)(a=o[r])&&e.call(a,a.__data__,r,o);return this}function pa(e){return function(){this.removeAttribute(e)}}function fa(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ma(e,i){return function(){this.setAttribute(e,i)}}function ga(e,i){return function(){this.setAttributeNS(e.space,e.local,i)}}function xa(e,i){return function(){var t=i.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function ya(e,i){return function(){var t=i.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function qo(e,i){var t=ot(e);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((i==null?t.local?fa:pa:typeof i=="function"?t.local?ya:xa:t.local?ga:ma)(t,i))}function Xn(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function va(e){return function(){this.style.removeProperty(e)}}function _a(e,i,t){return function(){this.style.setProperty(e,i,t)}}function Ca(e,i,t){return function(){var n=i.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,t)}}function Wo(e,i,t){return arguments.length>1?this.each((i==null?va:typeof i=="function"?Ca:_a)(e,i,t??"")):dt(this.node(),e)}function dt(e,i){return e.style.getPropertyValue(i)||Xn(e).getComputedStyle(e,null).getPropertyValue(i)}function wa(e){return function(){delete this[e]}}function Sa(e,i){return function(){this[e]=i}}function ba(e,i){return function(){var t=i.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function Xo(e,i){return arguments.length>1?this.each((i==null?wa:typeof i=="function"?ba:Sa)(e,i)):this.node()[e]}function Yo(e){return e.trim().split(/^|\s+/)}function Ri(e){return e.classList||new Uo(e)}function Uo(e){this._node=e,this._names=Yo(e.getAttribute("class")||"")}Uo.prototype={add:function(e){var i=this._names.indexOf(e);i<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var i=this._names.indexOf(e);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Zo(e,i){for(var t=Ri(e),n=-1,o=i.length;++n<o;)t.add(i[n])}function Qo(e,i){for(var t=Ri(e),n=-1,o=i.length;++n<o;)t.remove(i[n])}function Ta(e){return function(){Zo(this,e)}}function Ea(e){return function(){Qo(this,e)}}function za(e,i){return function(){(i.apply(this,arguments)?Zo:Qo)(this,e)}}function Ko(e,i){var t=Yo(e+"");if(arguments.length<2){for(var n=Ri(this.node()),o=-1,r=t.length;++o<r;)if(!n.contains(t[o]))return!1;return!0}return this.each((typeof i=="function"?za:i?Ta:Ea)(t,i))}function Na(){this.textContent=""}function Ma(e){return function(){this.textContent=e}}function ka(e){return function(){var i=e.apply(this,arguments);this.textContent=i??""}}function Jo(e){return arguments.length?this.each(e==null?Na:(typeof e=="function"?ka:Ma)(e)):this.node().textContent}function Oa(){this.innerHTML=""}function Da(e){return function(){this.innerHTML=e}}function Ia(e){return function(){var i=e.apply(this,arguments);this.innerHTML=i??""}}function er(e){return arguments.length?this.each(e==null?Oa:(typeof e=="function"?Ia:Da)(e)):this.node().innerHTML}function Ha(){this.nextSibling&&this.parentNode.appendChild(this)}function tr(){return this.each(Ha)}function Ra(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nr(){return this.each(Ra)}function ir(e){var i=typeof e=="function"?e:Gn(e);return this.select(function(){return this.appendChild(i.apply(this,arguments))})}function Pa(){return null}function or(e,i){var t=typeof e=="function"?e:Gn(e),n=i==null?Pa:typeof i=="function"?i:bt(i);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function Fa(){var e=this.parentNode;e&&e.removeChild(this)}function rr(){return this.each(Fa)}function Va(){var e=this.cloneNode(!1),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function $a(){var e=this.cloneNode(!0),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function sr(e){return this.select(e?$a:Va)}function ar(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Aa(e){return function(i){e.call(this,i,this.__data__)}}function Ba(e){return e.trim().split(/^|\s+/).map(function(i){var t="",n=i.indexOf(".");return n>=0&&(t=i.slice(n+1),i=i.slice(0,n)),{type:i,name:t}})}function La(e){return function(){var i=this.__on;if(i){for(var t=0,n=-1,o=i.length,r;t<o;++t)r=i[t],(!e.type||r.type===e.type)&&r.name===e.name?this.removeEventListener(r.type,r.listener,r.options):i[++n]=r;++n?i.length=n:delete this.__on}}}function ja(e,i,t){return function(){var n=this.__on,o,r=Aa(i);if(n){for(var s=0,a=n.length;s<a;++s)if((o=n[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=r,o.options=t),o.value=i;return}}this.addEventListener(e.type,r,t),o={type:e.type,name:e.name,value:i,listener:r,options:t},n?n.push(o):this.__on=[o]}}function lr(e,i,t){var n=Ba(e+""),o,r=n.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,c;l<u;++l)for(o=0,c=a[l];o<r;++o)if((s=n[o]).type===c.type&&s.name===c.name)return c.value}return}for(a=i?ja:La,o=0;o<r;++o)this.each(a(n[o],i,t));return this}function cr(e,i,t){var n=Xn(e),o=n.CustomEvent;typeof o=="function"?o=new o(i,t):(o=n.document.createEvent("Event"),t?(o.initEvent(i,t.bubbles,t.cancelable),o.detail=t.detail):o.initEvent(i,!1,!1)),e.dispatchEvent(o)}function Ga(e,i){return function(){return cr(this,e,i)}}function qa(e,i){return function(){return cr(this,e,i.apply(this,arguments))}}function ur(e,i){return this.each((typeof i=="function"?qa:Ga)(e,i))}function*dr(){for(var e=this._groups,i=0,t=e.length;i<t;++i)for(var n=e[i],o=0,r=n.length,s;o<r;++o)(s=n[o])&&(yield s)}var Pi=[null];function te(e,i){this._groups=e,this._parents=i}function hr(){return new te([[document.documentElement]],Pi)}function Wa(){return this}te.prototype=hr.prototype={constructor:te,select:Eo,selectAll:zo,selectChild:No,selectChildren:Mo,filter:ko,data:Io,enter:Oo,exit:Ho,join:Ro,merge:Po,selection:Wa,order:Fo,sort:Vo,call:$o,nodes:Ao,node:Bo,size:Lo,empty:jo,each:Go,attr:qo,style:Wo,property:Xo,classed:Ko,text:Jo,html:er,raise:tr,lower:nr,append:ir,insert:or,remove:rr,clone:sr,datum:ar,on:lr,dispatch:ur,[Symbol.iterator]:dr};var rt=hr;function le(e){return typeof e=="string"?new te([[document.querySelector(e)]],[document.documentElement]):new te([[e]],Pi)}function pr(e){let i;for(;i=e.sourceEvent;)e=i;return e}function ke(e,i){if(e=pr(e),i===void 0&&(i=e.currentTarget),i){var t=i.ownerSVGElement||i;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(i.getScreenCTM().inverse()),[n.x,n.y]}if(i.getBoundingClientRect){var o=i.getBoundingClientRect();return[e.clientX-o.left-i.clientLeft,e.clientY-o.top-i.clientTop]}}return[e.pageX,e.pageY]}var Xa={value:()=>{}};function mr(){for(var e=0,i=arguments.length,t={},n;e<i;++e){if(!(n=arguments[e]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Yn(t)}function Yn(e){this._=e}function Ya(e,i){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");if(o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Yn.prototype=mr.prototype={constructor:Yn,on:function(e,i){var t=this._,n=Ya(e+"",t),o,r=-1,s=n.length;if(arguments.length<2){for(;++r<s;)if((o=(e=n[r]).type)&&(o=Ua(t[o],e.name)))return o;return}if(i!=null&&typeof i!="function")throw new Error("invalid callback: "+i);for(;++r<s;)if(o=(e=n[r]).type)t[o]=fr(t[o],e.name,i);else if(i==null)for(o in t)t[o]=fr(t[o],e.name,null);return this},copy:function(){var e={},i=this._;for(var t in i)e[t]=i[t].slice();return new Yn(e)},call:function(e,i){if((o=arguments.length-2)>0)for(var t=new Array(o),n=0,o,r;n<o;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=this._[e],n=0,o=r.length;n<o;++n)r[n].value.apply(i,t)},apply:function(e,i,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],o=0,r=n.length;o<r;++o)n[o].value.apply(i,t)}};function Ua(e,i){for(var t=0,n=e.length,o;t<n;++t)if((o=e[t]).name===i)return o.value}function fr(e,i,t){for(var n=0,o=e.length;n<o;++n)if(e[n].name===i){e[n]=Xa,e=e.slice(0,n).concat(e.slice(n+1));break}return t!=null&&e.push({name:i,value:t}),e}var Tt=mr;var gr={passive:!1},Et={capture:!0,passive:!1};function Un(e){e.stopImmediatePropagation()}function ht(e){e.preventDefault(),e.stopImmediatePropagation()}function rn(e){var i=e.document.documentElement,t=le(e).on("dragstart.drag",ht,Et);"onselectstart"in i?t.on("selectstart.drag",ht,Et):(i.__noselect=i.style.MozUserSelect,i.style.MozUserSelect="none")}function sn(e,i){var t=e.document.documentElement,n=le(e).on("dragstart.drag",null);i&&(n.on("click.drag",ht,Et),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}var an=e=>()=>e;function ln(e,{sourceEvent:i,subject:t,target:n,identifier:o,active:r,x:s,y:a,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:i,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}ln.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Za(e){return!e.ctrlKey&&!e.button}function Qa(){return this.parentNode}function Ka(e,i){return i??{x:e.x,y:e.y}}function Ja(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zn(){var e=Za,i=Qa,t=Ka,n=Ja,o={},r=Tt("start","drag","end"),s=0,a,l,u,c,m=0;function p(g){g.on("mousedown.drag",y).filter(n).on("touchstart.drag",Z).on("touchmove.drag",b,gr).on("touchend.drag touchcancel.drag",me).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(g,E){if(!(c||!e.call(this,g,E))){var V=ge(this,i.call(this,g,E),g,E,"mouse");V&&(le(g.view).on("mousemove.drag",P,Et).on("mouseup.drag",$,Et),rn(g.view),Un(g),u=!1,a=g.clientX,l=g.clientY,V("start",g))}}function P(g){if(ht(g),!u){var E=g.clientX-a,V=g.clientY-l;u=E*E+V*V>m}o.mouse("drag",g)}function $(g){le(g.view).on("mousemove.drag mouseup.drag",null),sn(g.view,u),ht(g),o.mouse("end",g)}function Z(g,E){if(e.call(this,g,E)){var V=g.changedTouches,j=i.call(this,g,E),ce=V.length,_e,ie;for(_e=0;_e<ce;++_e)(ie=ge(this,j,g,E,V[_e].identifier,V[_e]))&&(Un(g),ie("start",g,V[_e]))}}function b(g){var E=g.changedTouches,V=E.length,j,ce;for(j=0;j<V;++j)(ce=o[E[j].identifier])&&(ht(g),ce("drag",g,E[j]))}function me(g){var E=g.changedTouches,V=E.length,j,ce;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),j=0;j<V;++j)(ce=o[E[j].identifier])&&(Un(g),ce("end",g,E[j]))}function ge(g,E,V,j,ce,_e){var ie=r.copy(),oe=ke(_e||V,E),yt,vt,d;if((d=t.call(g,new ln("beforestart",{sourceEvent:V,target:p,identifier:ce,active:s,x:oe[0],y:oe[1],dx:0,dy:0,dispatch:ie}),j))!=null)return yt=d.x-oe[0]||0,vt=d.y-oe[1]||0,function _(f,C,T){var z=oe,N;switch(f){case"start":o[ce]=_,N=s++;break;case"end":delete o[ce],--s;case"drag":oe=ke(T||C,E),N=s;break}ie.call(f,g,new ln(f,{sourceEvent:C,subject:d,target:p,identifier:ce,active:N,x:oe[0]+yt,y:oe[1]+vt,dx:oe[0]-z[0],dy:oe[1]-z[1],dispatch:ie}),j)}}return p.filter=function(g){return arguments.length?(e=typeof g=="function"?g:an(!!g),p):e},p.container=function(g){return arguments.length?(i=typeof g=="function"?g:an(g),p):i},p.subject=function(g){return arguments.length?(t=typeof g=="function"?g:an(g),p):t},p.touchable=function(g){return arguments.length?(n=typeof g=="function"?g:an(!!g),p):n},p.on=function(){var g=r.on.apply(r,arguments);return g===r?p:g},p.clickDistance=function(g){return arguments.length?(m=(g=+g)*g,p):Math.sqrt(m)},p}function Qn(e,i,t){e.prototype=i.prototype=t,t.constructor=e}function Fi(e,i){var t=Object.create(e.prototype);for(var n in i)t[n]=i[n];return t}function dn(){}var cn=.7,ei=1/cn,Lt="\\s*([+-]?\\d+)\\s*",un="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",el=/^#([0-9a-f]{3,8})$/,tl=new RegExp(`^rgb\\(${Lt},${Lt},${Lt}\\)$`),nl=new RegExp(`^rgb\\(${qe},${qe},${qe}\\)$`),il=new RegExp(`^rgba\\(${Lt},${Lt},${Lt},${un}\\)$`),ol=new RegExp(`^rgba\\(${qe},${qe},${qe},${un}\\)$`),rl=new RegExp(`^hsl\\(${un},${qe},${qe}\\)$`),sl=new RegExp(`^hsla\\(${un},${qe},${qe},${un}\\)$`),xr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Qn(dn,pt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:yr,formatHex:yr,formatHex8:al,formatHsl:ll,formatRgb:vr,toString:vr});function yr(){return this.rgb().formatHex()}function al(){return this.rgb().formatHex8()}function ll(){return Tr(this).formatHsl()}function vr(){return this.rgb().formatRgb()}function pt(e){var i,t;return e=(e+"").trim().toLowerCase(),(i=el.exec(e))?(t=i[1].length,i=parseInt(i[1],16),t===6?_r(i):t===3?new Te(i>>8&15|i>>4&240,i>>4&15|i&240,(i&15)<<4|i&15,1):t===8?Kn(i>>24&255,i>>16&255,i>>8&255,(i&255)/255):t===4?Kn(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|i&240,((i&15)<<4|i&15)/255):null):(i=tl.exec(e))?new Te(i[1],i[2],i[3],1):(i=nl.exec(e))?new Te(i[1]*255/100,i[2]*255/100,i[3]*255/100,1):(i=il.exec(e))?Kn(i[1],i[2],i[3],i[4]):(i=ol.exec(e))?Kn(i[1]*255/100,i[2]*255/100,i[3]*255/100,i[4]):(i=rl.exec(e))?Sr(i[1],i[2]/100,i[3]/100,1):(i=sl.exec(e))?Sr(i[1],i[2]/100,i[3]/100,i[4]):xr.hasOwnProperty(e)?_r(xr[e]):e==="transparent"?new Te(NaN,NaN,NaN,0):null}function _r(e){return new Te(e>>16&255,e>>8&255,e&255,1)}function Kn(e,i,t,n){return n<=0&&(e=i=t=NaN),new Te(e,i,t,n)}function cl(e){return e instanceof dn||(e=pt(e)),e?(e=e.rgb(),new Te(e.r,e.g,e.b,e.opacity)):new Te}function jt(e,i,t,n){return arguments.length===1?cl(e):new Te(e,i,t,n??1)}function Te(e,i,t,n){this.r=+e,this.g=+i,this.b=+t,this.opacity=+n}Qn(Te,jt,Fi(dn,{brighter(e){return e=e==null?ei:Math.pow(ei,e),new Te(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?cn:Math.pow(cn,e),new Te(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Te(Nt(this.r),Nt(this.g),Nt(this.b),ti(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Cr,formatHex:Cr,formatHex8:ul,formatRgb:wr,toString:wr}));function Cr(){return`#${zt(this.r)}${zt(this.g)}${zt(this.b)}`}function ul(){return`#${zt(this.r)}${zt(this.g)}${zt(this.b)}${zt((isNaN(this.opacity)?1:this.opacity)*255)}`}function wr(){let e=ti(this.opacity);return`${e===1?"rgb(":"rgba("}${Nt(this.r)}, ${Nt(this.g)}, ${Nt(this.b)}${e===1?")":`, ${e})`}`}function ti(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Nt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function zt(e){return e=Nt(e),(e<16?"0":"")+e.toString(16)}function Sr(e,i,t,n){return n<=0?e=i=t=NaN:t<=0||t>=1?e=i=NaN:i<=0&&(e=NaN),new He(e,i,t,n)}function Tr(e){if(e instanceof He)return new He(e.h,e.s,e.l,e.opacity);if(e instanceof dn||(e=pt(e)),!e)return new He;if(e instanceof He)return e;e=e.rgb();var i=e.r/255,t=e.g/255,n=e.b/255,o=Math.min(i,t,n),r=Math.max(i,t,n),s=NaN,a=r-o,l=(r+o)/2;return a?(i===r?s=(t-n)/a+(t<n)*6:t===r?s=(n-i)/a+2:s=(i-t)/a+4,a/=l<.5?r+o:2-r-o,s*=60):a=l>0&&l<1?0:s,new He(s,a,l,e.opacity)}function Er(e,i,t,n){return arguments.length===1?Tr(e):new He(e,i,t,n??1)}function He(e,i,t,n){this.h=+e,this.s=+i,this.l=+t,this.opacity=+n}Qn(He,Er,Fi(dn,{brighter(e){return e=e==null?ei:Math.pow(ei,e),new He(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?cn:Math.pow(cn,e),new He(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,i=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*i,o=2*t-n;return new Te(Vi(e>=240?e-240:e+120,o,n),Vi(e,o,n),Vi(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new He(br(this.h),Jn(this.s),Jn(this.l),ti(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=ti(this.opacity);return`${e===1?"hsl(":"hsla("}${br(this.h)}, ${Jn(this.s)*100}%, ${Jn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function br(e){return e=(e||0)%360,e<0?e+360:e}function Jn(e){return Math.max(0,Math.min(1,e||0))}function Vi(e,i,t){return(e<60?i+(t-i)*e/60:e<180?t:e<240?i+(t-i)*(240-e)/60:i)*255}function $i(e,i,t,n,o){var r=e*e,s=r*e;return((1-3*e+3*r-s)*i+(4-6*r+3*s)*t+(1+3*e+3*r-3*s)*n+s*o)/6}function zr(e){var i=e.length-1;return function(t){var n=t<=0?t=0:t>=1?(t=1,i-1):Math.floor(t*i),o=e[n],r=e[n+1],s=n>0?e[n-1]:2*o-r,a=n<i-1?e[n+2]:2*r-o;return $i((t-n/i)*i,s,o,r,a)}}function Nr(e){var i=e.length;return function(t){var n=Math.floor(((t%=1)<0?++t:t)*i),o=e[(n+i-1)%i],r=e[n%i],s=e[(n+1)%i],a=e[(n+2)%i];return $i((t-n/i)*i,o,r,s,a)}}var Ai=e=>()=>e;function dl(e,i){return function(t){return e+t*i}}function hl(e,i,t){return e=Math.pow(e,t),i=Math.pow(i,t)-e,t=1/t,function(n){return Math.pow(e+n*i,t)}}function Mr(e){return(e=+e)==1?ni:function(i,t){return t-i?hl(i,t,e):Ai(isNaN(i)?t:i)}}function ni(e,i){var t=i-e;return t?dl(e,t):Ai(isNaN(e)?i:e)}var ii=function e(i){var t=Mr(i);function n(o,r){var s=t((o=jt(o)).r,(r=jt(r)).r),a=t(o.g,r.g),l=t(o.b,r.b),u=ni(o.opacity,r.opacity);return function(c){return o.r=s(c),o.g=a(c),o.b=l(c),o.opacity=u(c),o+""}}return n.gamma=e,n}(1);function kr(e){return function(i){var t=i.length,n=new Array(t),o=new Array(t),r=new Array(t),s,a;for(s=0;s<t;++s)a=jt(i[s]),n[s]=a.r||0,o[s]=a.g||0,r[s]=a.b||0;return n=e(n),o=e(o),r=e(r),a.opacity=1,function(l){return a.r=n(l),a.g=o(l),a.b=r(l),a+""}}}var pl=kr(zr),fl=kr(Nr);function Oe(e,i){return e=+e,i=+i,function(t){return e*(1-t)+i*t}}var Li=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bi=new RegExp(Li.source,"g");function ml(e){return function(){return e}}function gl(e){return function(i){return e(i)+""}}function ji(e,i){var t=Li.lastIndex=Bi.lastIndex=0,n,o,r,s=-1,a=[],l=[];for(e=e+"",i=i+"";(n=Li.exec(e))&&(o=Bi.exec(i));)(r=o.index)>t&&(r=i.slice(t,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:Oe(n,o)})),t=Bi.lastIndex;return t<i.length&&(r=i.slice(t),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?gl(l[0].x):ml(i):(i=l.length,function(u){for(var c=0,m;c<i;++c)a[(m=l[c]).i]=m.x(u);return a.join("")})}var Or=180/Math.PI,oi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Gi(e,i,t,n,o,r){var s,a,l;return(s=Math.sqrt(e*e+i*i))&&(e/=s,i/=s),(l=e*t+i*n)&&(t-=e*l,n-=i*l),(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a,l/=a),e*n<i*t&&(e=-e,i=-i,l=-l,s=-s),{translateX:o,translateY:r,rotate:Math.atan2(i,e)*Or,skewX:Math.atan(l)*Or,scaleX:s,scaleY:a}}var ri;function Dr(e){let i=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return i.isIdentity?oi:Gi(i.a,i.b,i.c,i.d,i.e,i.f)}function Ir(e){return e==null?oi:(ri||(ri=document.createElementNS("http://www.w3.org/2000/svg","g")),ri.setAttribute("transform",e),(e=ri.transform.baseVal.consolidate())?(e=e.matrix,Gi(e.a,e.b,e.c,e.d,e.e,e.f)):oi)}function Hr(e,i,t,n){function o(u){return u.length?u.pop()+" ":""}function r(u,c,m,p,y,P){if(u!==m||c!==p){var $=y.push("translate(",null,i,null,t);P.push({i:$-4,x:Oe(u,m)},{i:$-2,x:Oe(c,p)})}else(m||p)&&y.push("translate("+m+i+p+t)}function s(u,c,m,p){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),p.push({i:m.push(o(m)+"rotate(",null,n)-2,x:Oe(u,c)})):c&&m.push(o(m)+"rotate("+c+n)}function a(u,c,m,p){u!==c?p.push({i:m.push(o(m)+"skewX(",null,n)-2,x:Oe(u,c)}):c&&m.push(o(m)+"skewX("+c+n)}function l(u,c,m,p,y,P){if(u!==m||c!==p){var $=y.push(o(y)+"scale(",null,",",null,")");P.push({i:$-4,x:Oe(u,m)},{i:$-2,x:Oe(c,p)})}else(m!==1||p!==1)&&y.push(o(y)+"scale("+m+","+p+")")}return function(u,c){var m=[],p=[];return u=e(u),c=e(c),r(u.translateX,u.translateY,c.translateX,c.translateY,m,p),s(u.rotate,c.rotate,m,p),a(u.skewX,c.skewX,m,p),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,m,p),u=c=null,function(y){for(var P=-1,$=p.length,Z;++P<$;)m[(Z=p[P]).i]=Z.x(y);return m.join("")}}}var qi=Hr(Dr,"px, ","px)","deg)"),Wi=Hr(Ir,", ",")",")");var xl=1e-12;function Rr(e){return((e=Math.exp(e))+1/e)/2}function yl(e){return((e=Math.exp(e))-1/e)/2}function vl(e){return((e=Math.exp(2*e))-1)/(e+1)}var Xi=function e(i,t,n){function o(r,s){var a=r[0],l=r[1],u=r[2],c=s[0],m=s[1],p=s[2],y=c-a,P=m-l,$=y*y+P*P,Z,b;if($<xl)b=Math.log(p/u)/i,Z=function(j){return[a+j*y,l+j*P,u*Math.exp(i*j*b)]};else{var me=Math.sqrt($),ge=(p*p-u*u+n*$)/(2*u*t*me),g=(p*p-u*u-n*$)/(2*p*t*me),E=Math.log(Math.sqrt(ge*ge+1)-ge),V=Math.log(Math.sqrt(g*g+1)-g);b=(V-E)/i,Z=function(j){var ce=j*b,_e=Rr(E),ie=u/(t*me)*(_e*vl(i*ce+E)-yl(E));return[a+ie*y,l+ie*P,u*_e/Rr(i*ce+E)]}}return Z.duration=b*1e3*i/Math.SQRT2,Z}return o.rho=function(r){var s=Math.max(.001,+r),a=s*s,l=a*a;return e(s,a,l)},o}(Math.SQRT2,2,4);var Gt=0,pn=0,hn=0,Fr=1e3,si,fn,ai=0,Mt=0,li=0,mn=typeof performance=="object"&&performance.now?performance:Date,Vr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function xn(){return Mt||(Vr(_l),Mt=mn.now()+li)}function _l(){Mt=0}function gn(){this._call=this._time=this._next=null}gn.prototype=ci.prototype={constructor:gn,restart:function(e,i,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?xn():+t)+(i==null?0:+i),!this._next&&fn!==this&&(fn?fn._next=this:si=this,fn=this),this._call=e,this._time=t,Yi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yi())}};function ci(e,i,t){var n=new gn;return n.restart(e,i,t),n}function $r(){xn(),++Gt;for(var e=si,i;e;)(i=Mt-e._time)>=0&&e._call.call(void 0,i),e=e._next;--Gt}function Pr(){Mt=(ai=mn.now())+li,Gt=pn=0;try{$r()}finally{Gt=0,wl(),Mt=0}}function Cl(){var e=mn.now(),i=e-ai;i>Fr&&(li-=i,ai=e)}function wl(){for(var e,i=si,t,n=1/0;i;)i._call?(n>i._time&&(n=i._time),e=i,i=i._next):(t=i._next,i._next=null,i=e?e._next=t:si=t);fn=e,Yi(n)}function Yi(e){if(!Gt){pn&&(pn=clearTimeout(pn));var i=e-Mt;i>24?(e<1/0&&(pn=setTimeout(Pr,e-mn.now()-li)),hn&&(hn=clearInterval(hn))):(hn||(ai=mn.now(),hn=setInterval(Cl,Fr)),Gt=1,Vr(Pr))}}function ui(e,i,t){var n=new gn;return i=i==null?0:+i,n.restart(o=>{n.stop(),e(o+i)},i,t),n}var Sl=Tt("start","end","cancel","interrupt"),bl=[],Lr=0,Ar=1,hi=2,di=3,Br=4,pi=5,yn=6;function ft(e,i,t,n,o,r){var s=e.__transition;if(!s)e.__transition={};else if(t in s)return;Tl(e,t,{name:i,index:n,group:o,on:Sl,tween:bl,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:Lr})}function vn(e,i){var t=fe(e,i);if(t.state>Lr)throw new Error("too late; already scheduled");return t}function ve(e,i){var t=fe(e,i);if(t.state>di)throw new Error("too late; already running");return t}function fe(e,i){var t=e.__transition;if(!t||!(t=t[i]))throw new Error("transition not found");return t}function Tl(e,i,t){var n=e.__transition,o;n[i]=t,t.timer=ci(r,0,t.time);function r(u){t.state=Ar,t.timer.restart(s,t.delay,t.time),t.delay<=u&&s(u-t.delay)}function s(u){var c,m,p,y;if(t.state!==Ar)return l();for(c in n)if(y=n[c],y.name===t.name){if(y.state===di)return ui(s);y.state===Br?(y.state=yn,y.timer.stop(),y.on.call("interrupt",e,e.__data__,y.index,y.group),delete n[c]):+c<i&&(y.state=yn,y.timer.stop(),y.on.call("cancel",e,e.__data__,y.index,y.group),delete n[c])}if(ui(function(){t.state===di&&(t.state=Br,t.timer.restart(a,t.delay,t.time),a(u))}),t.state=hi,t.on.call("start",e,e.__data__,t.index,t.group),t.state===hi){for(t.state=di,o=new Array(p=t.tween.length),c=0,m=-1;c<p;++c)(y=t.tween[c].value.call(e,e.__data__,t.index,t.group))&&(o[++m]=y);o.length=m+1}}function a(u){for(var c=u<t.duration?t.ease.call(null,u/t.duration):(t.timer.restart(l),t.state=pi,1),m=-1,p=o.length;++m<p;)o[m].call(e,c);t.state===pi&&(t.on.call("end",e,e.__data__,t.index,t.group),l())}function l(){t.state=yn,t.timer.stop(),delete n[i];for(var u in n)return;delete e.__transition}}function kt(e,i){var t=e.__transition,n,o,r=!0,s;if(t){i=i==null?null:i+"";for(s in t){if((n=t[s]).name!==i){r=!1;continue}o=n.state>hi&&n.state<pi,n.state=yn,n.timer.stop(),n.on.call(o?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete t[s]}r&&delete e.__transition}}function jr(e){return this.each(function(){kt(this,e)})}function El(e,i){var t,n;return function(){var o=ve(this,e),r=o.tween;if(r!==t){n=t=r;for(var s=0,a=n.length;s<a;++s)if(n[s].name===i){n=n.slice(),n.splice(s,1);break}}o.tween=n}}function zl(e,i,t){var n,o;if(typeof t!="function")throw new Error;return function(){var r=ve(this,e),s=r.tween;if(s!==n){o=(n=s).slice();for(var a={name:i,value:t},l=0,u=o.length;l<u;++l)if(o[l].name===i){o[l]=a;break}l===u&&o.push(a)}r.tween=o}}function Gr(e,i){var t=this._id;if(e+="",arguments.length<2){for(var n=fe(this.node(),t).tween,o=0,r=n.length,s;o<r;++o)if((s=n[o]).name===e)return s.value;return null}return this.each((i==null?El:zl)(t,e,i))}function qt(e,i,t){var n=e._id;return e.each(function(){var o=ve(this,n);(o.value||(o.value={}))[i]=t.apply(this,arguments)}),function(o){return fe(o,n).value[i]}}function fi(e,i){var t;return(typeof i=="number"?Oe:i instanceof pt?ii:(t=pt(i))?(i=t,ii):ji)(e,i)}function Nl(e){return function(){this.removeAttribute(e)}}function Ml(e){return function(){this.removeAttributeNS(e.space,e.local)}}function kl(e,i,t){var n,o=t+"",r;return function(){var s=this.getAttribute(e);return s===o?null:s===n?r:r=i(n=s,t)}}function Ol(e,i,t){var n,o=t+"",r;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===n?r:r=i(n=s,t)}}function Dl(e,i,t){var n,o,r;return function(){var s,a=t(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===n&&l===o?r:(o=l,r=i(n=s,a)))}}function Il(e,i,t){var n,o,r;return function(){var s,a=t(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===n&&l===o?r:(o=l,r=i(n=s,a)))}}function qr(e,i){var t=ot(e),n=t==="transform"?Wi:fi;return this.attrTween(e,typeof i=="function"?(t.local?Il:Dl)(t,n,qt(this,"attr."+e,i)):i==null?(t.local?Ml:Nl)(t):(t.local?Ol:kl)(t,n,i))}function Hl(e,i){return function(t){this.setAttribute(e,i.call(this,t))}}function Rl(e,i){return function(t){this.setAttributeNS(e.space,e.local,i.call(this,t))}}function Pl(e,i){var t,n;function o(){var r=i.apply(this,arguments);return r!==n&&(t=(n=r)&&Rl(e,r)),t}return o._value=i,o}function Fl(e,i){var t,n;function o(){var r=i.apply(this,arguments);return r!==n&&(t=(n=r)&&Hl(e,r)),t}return o._value=i,o}function Wr(e,i){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(i==null)return this.tween(t,null);if(typeof i!="function")throw new Error;var n=ot(e);return this.tween(t,(n.local?Pl:Fl)(n,i))}function Vl(e,i){return function(){vn(this,e).delay=+i.apply(this,arguments)}}function $l(e,i){return i=+i,function(){vn(this,e).delay=i}}function Xr(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?Vl:$l)(i,e)):fe(this.node(),i).delay}function Al(e,i){return function(){ve(this,e).duration=+i.apply(this,arguments)}}function Bl(e,i){return i=+i,function(){ve(this,e).duration=i}}function Yr(e){var i=this._id;return arguments.length?this.each((typeof e=="function"?Al:Bl)(i,e)):fe(this.node(),i).duration}function Ll(e,i){if(typeof i!="function")throw new Error;return function(){ve(this,e).ease=i}}function Ur(e){var i=this._id;return arguments.length?this.each(Ll(i,e)):fe(this.node(),i).ease}function jl(e,i){return function(){var t=i.apply(this,arguments);if(typeof t!="function")throw new Error;ve(this,e).ease=t}}function Zr(e){if(typeof e!="function")throw new Error;return this.each(jl(this._id,e))}function Qr(e){typeof e!="function"&&(e=nn(e));for(var i=this._groups,t=i.length,n=new Array(t),o=0;o<t;++o)for(var r=i[o],s=r.length,a=n[o]=[],l,u=0;u<s;++u)(l=r[u])&&e.call(l,l.__data__,u,r)&&a.push(l);return new we(n,this._parents,this._name,this._id)}function Kr(e){if(e._id!==this._id)throw new Error;for(var i=this._groups,t=e._groups,n=i.length,o=t.length,r=Math.min(n,o),s=new Array(n),a=0;a<r;++a)for(var l=i[a],u=t[a],c=l.length,m=s[a]=new Array(c),p,y=0;y<c;++y)(p=l[y]||u[y])&&(m[y]=p);for(;a<n;++a)s[a]=i[a];return new we(s,this._parents,this._name,this._id)}function Gl(e){return(e+"").trim().split(/^|\s+/).every(function(i){var t=i.indexOf(".");return t>=0&&(i=i.slice(0,t)),!i||i==="start"})}function ql(e,i,t){var n,o,r=Gl(i)?vn:ve;return function(){var s=r(this,e),a=s.on;a!==n&&(o=(n=a).copy()).on(i,t),s.on=o}}function Jr(e,i){var t=this._id;return arguments.length<2?fe(this.node(),t).on.on(e):this.each(ql(t,e,i))}function Wl(e){return function(){var i=this.parentNode;for(var t in this.__transition)if(+t!==e)return;i&&i.removeChild(this)}}function es(){return this.on("end.remove",Wl(this._id))}function ts(e){var i=this._name,t=this._id;typeof e!="function"&&(e=bt(e));for(var n=this._groups,o=n.length,r=new Array(o),s=0;s<o;++s)for(var a=n[s],l=a.length,u=r[s]=new Array(l),c,m,p=0;p<l;++p)(c=a[p])&&(m=e.call(c,c.__data__,p,a))&&("__data__"in c&&(m.__data__=c.__data__),u[p]=m,ft(u[p],i,t,p,u,fe(c,t)));return new we(r,this._parents,i,t)}function ns(e){var i=this._name,t=this._id;typeof e!="function"&&(e=tn(e));for(var n=this._groups,o=n.length,r=[],s=[],a=0;a<o;++a)for(var l=n[a],u=l.length,c,m=0;m<u;++m)if(c=l[m]){for(var p=e.call(c,c.__data__,m,l),y,P=fe(c,t),$=0,Z=p.length;$<Z;++$)(y=p[$])&&ft(y,i,t,$,p,P);r.push(p),s.push(c)}return new we(r,s,i,t)}var Xl=rt.prototype.constructor;function is(){return new Xl(this._groups,this._parents)}function Yl(e,i){var t,n,o;return function(){var r=dt(this,e),s=(this.style.removeProperty(e),dt(this,e));return r===s?null:r===t&&s===n?o:o=i(t=r,n=s)}}function os(e){return function(){this.style.removeProperty(e)}}function Ul(e,i,t){var n,o=t+"",r;return function(){var s=dt(this,e);return s===o?null:s===n?r:r=i(n=s,t)}}function Zl(e,i,t){var n,o,r;return function(){var s=dt(this,e),a=t(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),dt(this,e))),s===l?null:s===n&&l===o?r:(o=l,r=i(n=s,a))}}function Ql(e,i){var t,n,o,r="style."+i,s="end."+r,a;return function(){var l=ve(this,e),u=l.on,c=l.value[r]==null?a||(a=os(i)):void 0;(u!==t||o!==c)&&(n=(t=u).copy()).on(s,o=c),l.on=n}}function rs(e,i,t){var n=(e+="")=="transform"?qi:fi;return i==null?this.styleTween(e,Yl(e,n)).on("end.style."+e,os(e)):typeof i=="function"?this.styleTween(e,Zl(e,n,qt(this,"style."+e,i))).each(Ql(this._id,e)):this.styleTween(e,Ul(e,n,i),t).on("end.style."+e,null)}function Kl(e,i,t){return function(n){this.style.setProperty(e,i.call(this,n),t)}}function Jl(e,i,t){var n,o;function r(){var s=i.apply(this,arguments);return s!==o&&(n=(o=s)&&Kl(e,s,t)),n}return r._value=i,r}function ss(e,i,t){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(i==null)return this.tween(n,null);if(typeof i!="function")throw new Error;return this.tween(n,Jl(e,i,t??""))}function ec(e){return function(){this.textContent=e}}function tc(e){return function(){var i=e(this);this.textContent=i??""}}function as(e){return this.tween("text",typeof e=="function"?tc(qt(this,"text",e)):ec(e==null?"":e+""))}function nc(e){return function(i){this.textContent=e.call(this,i)}}function ic(e){var i,t;function n(){var o=e.apply(this,arguments);return o!==t&&(i=(t=o)&&nc(o)),i}return n._value=e,n}function ls(e){var i="text";if(arguments.length<1)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,ic(e))}function cs(){for(var e=this._name,i=this._id,t=mi(),n=this._groups,o=n.length,r=0;r<o;++r)for(var s=n[r],a=s.length,l,u=0;u<a;++u)if(l=s[u]){var c=fe(l,i);ft(l,e,t,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new we(n,this._parents,e,t)}function us(){var e,i,t=this,n=t._id,o=t.size();return new Promise(function(r,s){var a={value:s},l={value:function(){--o===0&&r()}};t.each(function(){var u=ve(this,n),c=u.on;c!==e&&(i=(e=c).copy(),i._.cancel.push(a),i._.interrupt.push(a),i._.end.push(l)),u.on=i}),o===0&&r()})}var oc=0;function we(e,i,t,n){this._groups=e,this._parents=i,this._name=t,this._id=n}function ds(e){return rt().transition(e)}function mi(){return++oc}var st=rt.prototype;we.prototype=ds.prototype={constructor:we,select:ts,selectAll:ns,selectChild:st.selectChild,selectChildren:st.selectChildren,filter:Qr,merge:Kr,selection:is,transition:cs,call:st.call,nodes:st.nodes,node:st.node,size:st.size,empty:st.empty,each:st.each,on:Jr,attr:qr,attrTween:Wr,style:rs,styleTween:ss,text:as,textTween:ls,remove:es,tween:Gr,delay:Xr,duration:Yr,ease:Ur,easeVarying:Zr,end:us,[Symbol.iterator]:st[Symbol.iterator]};function gi(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var rc={time:null,delay:0,duration:250,ease:gi};function sc(e,i){for(var t;!(t=e.__transition)||!(t=t[i]);)if(!(e=e.parentNode))throw new Error(`transition ${i} not found`);return t}function hs(e){var i,t;e instanceof we?(i=e._id,e=e._name):(i=mi(),(t=rc).time=xn(),e=e==null?null:e+"");for(var n=this._groups,o=n.length,r=0;r<o;++r)for(var s=n[r],a=s.length,l,u=0;u<a;++u)(l=s[u])&&ft(l,e,i,u,s,t||sc(l,i));return new we(n,this._parents,e,i)}rt.prototype.interrupt=jr;rt.prototype.transition=hs;var _n=e=>()=>e;function Ui(e,{sourceEvent:i,target:t,transform:n,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:i,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:o}})}function Re(e,i,t){this.k=e,this.x=i,this.y=t}Re.prototype={constructor:Re,scale:function(e){return e===1?this:new Re(this.k*e,this.x,this.y)},translate:function(e,i){return e===0&i===0?this:new Re(this.k,this.x+this.k*e,this.y+this.k*i)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var mt=new Re(1,0,0);Zi.prototype=Re.prototype;function Zi(e){for(;!e.__zoom;)if(!(e=e.parentNode))return mt;return e.__zoom}function xi(e){e.stopImmediatePropagation()}function Wt(e){e.preventDefault(),e.stopImmediatePropagation()}function ac(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function lc(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ps(){return this.__zoom||mt}function cc(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function uc(){return navigator.maxTouchPoints||"ontouchstart"in this}function dc(e,i,t){var n=e.invertX(i[0][0])-t[0][0],o=e.invertX(i[1][0])-t[1][0],r=e.invertY(i[0][1])-t[0][1],s=e.invertY(i[1][1])-t[1][1];return e.translate(o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o),s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s))}function Qi(){var e=ac,i=lc,t=dc,n=cc,o=uc,r=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Xi,u=Tt("start","zoom","end"),c,m,p,y=500,P=150,$=0,Z=10;function b(d){d.property("__zoom",ps).on("wheel.zoom",ce,{passive:!1}).on("mousedown.zoom",_e).on("dblclick.zoom",ie).filter(o).on("touchstart.zoom",oe).on("touchmove.zoom",yt).on("touchend.zoom touchcancel.zoom",vt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(d,_,f,C){var T=d.selection?d.selection():d;T.property("__zoom",ps),d!==T?E(d,_,f,C):T.interrupt().each(function(){V(this,arguments).event(C).start().zoom(null,typeof _=="function"?_.apply(this,arguments):_).end()})},b.scaleBy=function(d,_,f,C){b.scaleTo(d,function(){var T=this.__zoom.k,z=typeof _=="function"?_.apply(this,arguments):_;return T*z},f,C)},b.scaleTo=function(d,_,f,C){b.transform(d,function(){var T=i.apply(this,arguments),z=this.__zoom,N=f==null?g(T):typeof f=="function"?f.apply(this,arguments):f,Y=z.invert(N),ne=typeof _=="function"?_.apply(this,arguments):_;return t(ge(me(z,ne),N,Y),T,s)},f,C)},b.translateBy=function(d,_,f,C){b.transform(d,function(){return t(this.__zoom.translate(typeof _=="function"?_.apply(this,arguments):_,typeof f=="function"?f.apply(this,arguments):f),i.apply(this,arguments),s)},null,C)},b.translateTo=function(d,_,f,C,T){b.transform(d,function(){var z=i.apply(this,arguments),N=this.__zoom,Y=C==null?g(z):typeof C=="function"?C.apply(this,arguments):C;return t(mt.translate(Y[0],Y[1]).scale(N.k).translate(typeof _=="function"?-_.apply(this,arguments):-_,typeof f=="function"?-f.apply(this,arguments):-f),z,s)},C,T)};function me(d,_){return _=Math.max(r[0],Math.min(r[1],_)),_===d.k?d:new Re(_,d.x,d.y)}function ge(d,_,f){var C=_[0]-f[0]*d.k,T=_[1]-f[1]*d.k;return C===d.x&&T===d.y?d:new Re(d.k,C,T)}function g(d){return[(+d[0][0]+ +d[1][0])/2,(+d[0][1]+ +d[1][1])/2]}function E(d,_,f,C){d.on("start.zoom",function(){V(this,arguments).event(C).start()}).on("interrupt.zoom end.zoom",function(){V(this,arguments).event(C).end()}).tween("zoom",function(){var T=this,z=arguments,N=V(T,z).event(C),Y=i.apply(T,z),ne=f==null?g(Y):typeof f=="function"?f.apply(T,z):f,Fe=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),xe=T.__zoom,De=typeof _=="function"?_.apply(T,z):_,Xe=l(xe.invert(ne).concat(Fe/xe.k),De.invert(ne).concat(Fe/De.k));return function(Ie){if(Ie===1)Ie=De;else{var Ye=Xe(Ie),Si=Fe/Ye[2];Ie=new Re(Si,ne[0]-Ye[0]*Si,ne[1]-Ye[1]*Si)}N.zoom(null,Ie)}})}function V(d,_,f){return!f&&d.__zooming||new j(d,_)}function j(d,_){this.that=d,this.args=_,this.active=0,this.sourceEvent=null,this.extent=i.apply(d,_),this.taps=0}j.prototype={event:function(d){return d&&(this.sourceEvent=d),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(d,_){return this.mouse&&d!=="mouse"&&(this.mouse[1]=_.invert(this.mouse[0])),this.touch0&&d!=="touch"&&(this.touch0[1]=_.invert(this.touch0[0])),this.touch1&&d!=="touch"&&(this.touch1[1]=_.invert(this.touch1[0])),this.that.__zoom=_,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(d){var _=le(this.that).datum();u.call(d,this.that,new Ui(d,{sourceEvent:this.sourceEvent,target:b,type:d,transform:this.that.__zoom,dispatch:u}),_)}};function ce(d,..._){if(!e.apply(this,arguments))return;var f=V(this,_).event(d),C=this.__zoom,T=Math.max(r[0],Math.min(r[1],C.k*Math.pow(2,n.apply(this,arguments)))),z=ke(d);if(f.wheel)(f.mouse[0][0]!==z[0]||f.mouse[0][1]!==z[1])&&(f.mouse[1]=C.invert(f.mouse[0]=z)),clearTimeout(f.wheel);else{if(C.k===T)return;f.mouse=[z,C.invert(z)],kt(this),f.start()}Wt(d),f.wheel=setTimeout(N,P),f.zoom("mouse",t(ge(me(C,T),f.mouse[0],f.mouse[1]),f.extent,s));function N(){f.wheel=null,f.end()}}function _e(d,..._){if(p||!e.apply(this,arguments))return;var f=d.currentTarget,C=V(this,_,!0).event(d),T=le(d.view).on("mousemove.zoom",ne,!0).on("mouseup.zoom",Fe,!0),z=ke(d,f),N=d.clientX,Y=d.clientY;rn(d.view),xi(d),C.mouse=[z,this.__zoom.invert(z)],kt(this),C.start();function ne(xe){if(Wt(xe),!C.moved){var De=xe.clientX-N,Xe=xe.clientY-Y;C.moved=De*De+Xe*Xe>$}C.event(xe).zoom("mouse",t(ge(C.that.__zoom,C.mouse[0]=ke(xe,f),C.mouse[1]),C.extent,s))}function Fe(xe){T.on("mousemove.zoom mouseup.zoom",null),sn(xe.view,C.moved),Wt(xe),C.event(xe).end()}}function ie(d,..._){if(e.apply(this,arguments)){var f=this.__zoom,C=ke(d.changedTouches?d.changedTouches[0]:d,this),T=f.invert(C),z=f.k*(d.shiftKey?.5:2),N=t(ge(me(f,z),C,T),i.apply(this,_),s);Wt(d),a>0?le(this).transition().duration(a).call(E,N,C,d):le(this).call(b.transform,N,C,d)}}function oe(d,..._){if(e.apply(this,arguments)){var f=d.touches,C=f.length,T=V(this,_,d.changedTouches.length===C).event(d),z,N,Y,ne;for(xi(d),N=0;N<C;++N)Y=f[N],ne=ke(Y,this),ne=[ne,this.__zoom.invert(ne),Y.identifier],T.touch0?!T.touch1&&T.touch0[2]!==ne[2]&&(T.touch1=ne,T.taps=0):(T.touch0=ne,z=!0,T.taps=1+!!c);c&&(c=clearTimeout(c)),z&&(T.taps<2&&(m=ne[0],c=setTimeout(function(){c=null},y)),kt(this),T.start())}}function yt(d,..._){if(this.__zooming){var f=V(this,_).event(d),C=d.changedTouches,T=C.length,z,N,Y,ne;for(Wt(d),z=0;z<T;++z)N=C[z],Y=ke(N,this),f.touch0&&f.touch0[2]===N.identifier?f.touch0[0]=Y:f.touch1&&f.touch1[2]===N.identifier&&(f.touch1[0]=Y);if(N=f.that.__zoom,f.touch1){var Fe=f.touch0[0],xe=f.touch0[1],De=f.touch1[0],Xe=f.touch1[1],Ie=(Ie=De[0]-Fe[0])*Ie+(Ie=De[1]-Fe[1])*Ie,Ye=(Ye=Xe[0]-xe[0])*Ye+(Ye=Xe[1]-xe[1])*Ye;N=me(N,Math.sqrt(Ie/Ye)),Y=[(Fe[0]+De[0])/2,(Fe[1]+De[1])/2],ne=[(xe[0]+Xe[0])/2,(xe[1]+Xe[1])/2]}else if(f.touch0)Y=f.touch0[0],ne=f.touch0[1];else return;f.zoom("touch",t(ge(N,Y,ne),f.extent,s))}}function vt(d,..._){if(this.__zooming){var f=V(this,_).event(d),C=d.changedTouches,T=C.length,z,N;for(xi(d),p&&clearTimeout(p),p=setTimeout(function(){p=null},y),z=0;z<T;++z)N=C[z],f.touch0&&f.touch0[2]===N.identifier?delete f.touch0:f.touch1&&f.touch1[2]===N.identifier&&delete f.touch1;if(f.touch1&&!f.touch0&&(f.touch0=f.touch1,delete f.touch1),f.touch0)f.touch0[1]=this.__zoom.invert(f.touch0[0]);else if(f.end(),f.taps===2&&(N=ke(N,this),Math.hypot(m[0]-N[0],m[1]-N[1])<Z)){var Y=le(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return b.wheelDelta=function(d){return arguments.length?(n=typeof d=="function"?d:_n(+d),b):n},b.filter=function(d){return arguments.length?(e=typeof d=="function"?d:_n(!!d),b):e},b.touchable=function(d){return arguments.length?(o=typeof d=="function"?d:_n(!!d),b):o},b.extent=function(d){return arguments.length?(i=typeof d=="function"?d:_n([[+d[0][0],+d[0][1]],[+d[1][0],+d[1][1]]]),b):i},b.scaleExtent=function(d){return arguments.length?(r[0]=+d[0],r[1]=+d[1],b):[r[0],r[1]]},b.translateExtent=function(d){return arguments.length?(s[0][0]=+d[0][0],s[1][0]=+d[1][0],s[0][1]=+d[0][1],s[1][1]=+d[1][1],b):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},b.constrain=function(d){return arguments.length?(t=d,b):t},b.duration=function(d){return arguments.length?(a=+d,b):a},b.interpolate=function(d){return arguments.length?(l=d,b):l},b.on=function(){var d=u.on.apply(u,arguments);return d===u?b:d},b.clickDistance=function(d){return arguments.length?($=(d=+d)*d,b):Math.sqrt($)},b.tapDistance=function(d){return arguments.length?(Z=+d,b):Z},b}function Me(e){return e!==void 0}function Ki(){let e=window.navigator.userAgent.toLowerCase(),i=/(macintosh|macintel|macppc|mac68k|macos)/i,t=/(win32|win64|windows|wince)/i,n=/(iphone|ipad|ipod)/i,o=null;return i.test(e)?o="macos":n.test(e)?o="ios":t.test(e)?o="windows":/android/.test(e)?o="android":!o&&/linux/.test(e)&&(o="linux"),o}var Cn=(()=>{class e{constructor(){this.actions=S({multiSelection:[Ki()==="macos"?"MetaLeft":"ControlLeft",Ki()==="macos"?"MetaRight":"ControlRight"]}),this.actionsActive={multiSelection:!1},X(this.actions).pipe(Ee(()=>ue($e(document,"keydown").pipe(ee(t=>{for(let n in this.actions())(this.actions()[n]??[]).includes(t.code)&&(this.actionsActive[n]=!0)})),$e(document,"keyup").pipe(ee(t=>{for(let n in this.actions())(this.actions()[n]??[]).includes(t.code)&&(this.actionsActive[n]=!1)})))),he()).subscribe()}setShortcuts(t){this.actions.update(n=>Yt(Yt({},n),t))}isActiveAction(t){return this.actionsActive[t]}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var gt=(()=>{class e{constructor(){this.flowEntitiesService=h(pe),this.keyboardService=h(Cn),this.viewport$=new Ve,this.resetSelection=this.viewport$.pipe(ee(({start:t,end:n,target:o})=>{if(t&&n&&o){let r=e.delta,s=Math.abs(n.x-t.x),a=Math.abs(n.y-t.y),l=s<r&&a<r,u=!o.closest(".selectable");l&&u&&this.select(null)}}),he()).subscribe()}static{this.delta=6}setViewport(t){this.viewport$.next(t)}select(t){t?.selected()||(this.keyboardService.isActiveAction("multiSelection")||this.flowEntitiesService.entities().forEach(n=>n.selected.set(!1)),t&&t.selected.set(!0))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var yi=(()=>{class e{constructor(){this.rootSvg=h(ct).element,this.host=h(se).nativeElement,this.selectionService=h(gt),this.viewportService=h(nt),this.flowSettingsService=h(ye),this.rootSvgSelection=le(this.rootSvg),this.zoomableSelection=le(this.host),this.viewportForSelection={},this.manualViewportChangeEffect=Ce(()=>{let t=this.viewportService.writableViewport(),n=t.state;if(t.changeType!=="initial"){if(Me(n.zoom)&&!Me(n.x)&&!Me(n.y)){this.rootSvgSelection.transition().duration(t.duration).call(this.zoomBehavior.scaleTo,n.zoom);return}if(Me(n.x)&&Me(n.y)&&!Me(n.zoom)){let o=wt(this.viewportService.readableViewport).zoom;this.rootSvgSelection.transition().duration(t.duration).call(this.zoomBehavior.transform,mt.translate(n.x,n.y).scale(o));return}if(Me(n.x)&&Me(n.y)&&Me(n.zoom)){this.rootSvgSelection.transition().duration(t.duration).call(this.zoomBehavior.transform,mt.translate(n.x,n.y).scale(n.zoom));return}}},{allowSignalWrites:!0}),this.handleZoom=({transform:t})=>{this.viewportService.readableViewport.set(Ji(t)),this.zoomableSelection.attr("transform",t.toString())},this.handleZoomStart=({transform:t})=>{this.viewportForSelection={start:Ji(t)}},this.handleZoomEnd=({transform:t,sourceEvent:n})=>{this.viewportForSelection=oo(Yt({},this.viewportForSelection),{end:Ji(t),target:hc(n)}),this.selectionService.setViewport(this.viewportForSelection)},this.filterCondition=t=>t.type==="mousedown"||t.type==="touchstart"?t.target.closest(".vflow-node")===null:!0}ngOnInit(){this.zoomBehavior=Qi().scaleExtent([this.flowSettingsService.minZoom(),this.flowSettingsService.maxZoom()]).filter(this.filterCondition).on("start",this.handleZoomStart).on("zoom",this.handleZoom).on("end",this.handleZoomEnd),this.rootSvgSelection.call(this.zoomBehavior).on("dblclick.zoom",null)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["g","mapContext",""]],standalone:!0})}}return e})(),Ji=e=>({zoom:e.k,x:e.x,y:e.y}),hc=e=>{if(e instanceof Event&&e.target instanceof Element)return e.target};var vi=(()=>{class e{constructor(){this.entitiesService=h(pe)}enable(t,n){le(t).call(this.getDragBehavior(n))}disable(t){le(t).call(Zn().on("drag",null))}destroy(t){le(t).on(".drag",null)}getDragBehavior(t){let n=[],o=[],r=s=>t.dragHandlesCount()?!!s.target.closest(".vflow-drag-handle"):!0;return Zn().filter(r).on("start",s=>{n=this.getDragNodes(t),o=n.map(a=>({x:a.point().x-s.x,y:a.point().y-s.y}))}).on("drag",s=>{n.forEach((a,l)=>{let u={x:Bt(s.x+o[l].x),y:Bt(s.y+o[l].y)};pc(a,u)})})}getDragNodes(t){return t.selected()?this.entitiesService.nodes().filter(n=>n.selected()&&n.draggable()):[t]}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();function pc(e,i){let t=e.parent();t&&(i.x=Math.min(t.size().width-e.size().width,i.x),i.x=Math.max(0,i.x),i.y=Math.min(t.size().height-e.size().height,i.y),i.y=Math.max(0,i.y)),e.setPoint(i,!0)}function eo(e,i){let t=e.reduce((n,o)=>(n[o.node.id]=o,n),{});i.forEach(n=>{n.source.set(t[n.edge.source]),n.target.set(t[n.edge.target])})}var We=(()=>{class e{constructor(){this.status=S({state:"idle",payload:null})}setIdleStatus(){this.status.set({state:"idle",payload:null})}setConnectionStartStatus(t,n){this.status.set({state:"connection-start",payload:{source:t,sourceHandle:n}})}setConnectionValidationStatus(t,n,o,r,s){this.status.set({state:"connection-validation",payload:{source:n,target:o,sourceHandle:r,targetHandle:s,valid:t}})}setConnectionEndStatus(t,n,o,r){this.status.set({state:"connection-end",payload:{source:t,target:n,sourceHandle:o,targetHandle:r}})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();function fs(...e){if(e.length){let[i,...t]=e;i(),t.forEach(n=>setTimeout(()=>n()))}}function to(e){let i={};return e.sourceHandle.rawHandle.type==="source"?(i.source=e.source,i.sourceHandle=e.sourceHandle):(i.source=e.target,i.sourceHandle=e.targetHandle),e.targetHandle.rawHandle.type==="target"?(i.target=e.target,i.targetHandle=e.targetHandle):(i.target=e.source,i.targetHandle=e.sourceHandle),i}var _i=(()=>{class e{constructor(){this.onConnect=Ct(),this.statusService=h(We),this.flowEntitiesService=h(pe),this.connectEffect=Ce(()=>{let t=this.statusService.status();if(t.state==="connection-end"){let n=t.payload.source,o=t.payload.target,r=t.payload.sourceHandle,s=t.payload.targetHandle;if(this.isStrictMode()){let y=to({source:t.payload.source,sourceHandle:t.payload.sourceHandle,target:t.payload.target,targetHandle:t.payload.targetHandle});n=y.source,o=y.target,r=y.sourceHandle,s=y.targetHandle}let a=n.node.id,l=o.node.id,u=r.rawHandle.id,c=s.rawHandle.id,m=this.flowEntitiesService.connection(),p={source:a,target:l,sourceHandle:u,targetHandle:c};m.validator(p)&&this.onConnect.emit(p)}},{allowSignalWrites:!0}),this.isStrictMode=v(()=>this.flowEntitiesService.connection().mode==="strict")}startConnection(t){this.statusService.setConnectionStartStatus(t.parentNode,t)}validateConnection(t){let n=this.statusService.status();if(n.state==="connection-start"){let o=n.payload.source,r=t.parentNode,s=n.payload.sourceHandle,a=t;if(this.isStrictMode()){let u=to({source:n.payload.source,sourceHandle:n.payload.sourceHandle,target:t.parentNode,targetHandle:t});o=u.source,r=u.target,s=u.sourceHandle,a=u.targetHandle}let l=this.flowEntitiesService.connection().validator({source:o.node.id,target:r.node.id,sourceHandle:s.rawHandle.id,targetHandle:a.rawHandle.id});t.state.set(l?"valid":"invalid"),this.statusService.setConnectionValidationStatus(l,n.payload.source,t.parentNode,n.payload.sourceHandle,t)}}resetValidateConnection(t){t.state.set("idle");let n=this.statusService.status();n.state==="connection-validation"&&this.statusService.setConnectionStartStatus(n.payload.source,n.payload.sourceHandle)}endConnection(t){let n=this.statusService.status();if(n.state==="connection-validation"){let o=n.payload.source,r=n.payload.sourceHandle,s=n.payload.target,a=n.payload.targetHandle;fs(()=>this.statusService.setConnectionEndStatus(o,s,r,a),()=>this.statusService.setIdleStatus())}}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["","connectionController",""]],outputs:{onConnect:"onConnect"},standalone:!0})}}return e})();var ms=(()=>{class e{static{this.defaultWidth=100}static{this.defaultHeight=50}static{this.defaultColor="#1b262c"}constructor(t){this.node=t,this.flowSettingsService=h(ye),this.entitiesService=h(pe),this.internalPoint=this.createInternalPointSignal(),this.throttledPoint$=X(this.internalPoint).pipe(Ue(Ut)),this.notThrottledPoint$=new Ve,this.point=Ne(ue(this.throttledPoint$,this.notThrottledPoint$),{initialValue:this.internalPoint()}),this.point$=this.throttledPoint$,this.size=S({width:0,height:0}),this.size$=X(this.size),this.width=v(()=>this.size().width),this.height=v(()=>this.size().height),this.renderOrder=S(0),this.selected=S(!1),this.selected$=X(this.selected),this.globalPoint=v(()=>{let n=this.parent(),o=this.point().x,r=this.point().y;for(;n!==null;)o+=n.point().x,r+=n.point().y,n=n.parent();return{x:o,y:r}}),this.pointTransform=v(()=>`translate(${this.globalPoint().x}, ${this.globalPoint().y})`),this.handles=S([]),this.handles$=X(this.handles),this.draggable=S(!0),this.dragHandlesCount=S(0),this.magnetRadius=20,this.isComponentType=$n.isPrototypeOf(this.node.type)||wo.isPrototypeOf(this.node.type),this.text=this.createTextSignal(),this.componentTypeInputs={node:this.node},this.parent=v(()=>this.entitiesService.nodes().find(n=>n.node.id===this.parentId())??null),this.children=v(()=>this.entitiesService.nodes().filter(n=>n.parentId()===this.node.id)),this.color=S(e.defaultColor),this.resizable=S(!1),this.resizing=S(!1),this.resizerTemplate=S(null),this.parentId=S(null),Me(t.draggable)&&(et(t)?this.draggable=t.draggable:this.draggable.set(t.draggable)),Me(t.parentId)&&(et(t)?this.parentId=t.parentId:this.parentId.set(t.parentId)),t.type==="default-group"&&t.color&&(et(t)?this.color=t.color:this.color.set(t.color)),t.type==="default-group"&&t.resizable&&(et(t)?this.resizable=t.resizable:this.resizable.set(t.resizable))}setPoint(t,n){n?this.internalPoint.set(t):this.notThrottledPoint$.next(t)}linkDefaultNodeSizeWithModelSize(){let t=this.node;switch(t.type){case"default":case"default-group":case"template-group":et(t)?Ce(()=>{this.size.set({width:t.width?.()??e.defaultWidth,height:t.height?.()??e.defaultHeight})},{allowSignalWrites:!0}):this.size.set({width:t.width??e.defaultWidth,height:t.height??e.defaultHeight})}(t.type==="html-template"||this.isComponentType)&&(et(t)?Ce(()=>{t.width&&t.height&&this.size.set({width:t.width(),height:t.height()})},{allowSignalWrites:!0}):t.width&&t.height&&this.size.set({width:t.width,height:t.height}))}createTextSignal(){let t=this.node;return t.type==="default"?et(t)?t.text??S(""):S(t.text??""):S("")}createInternalPointSignal(){return et(this.node)?this.node.point:S({x:this.node.point.x,y:this.node.point.y})}}return e})();var Xt=class{constructor(i){this.edgeLabel=i,this.size=S({width:0,height:0})}};function Pe(e,i,t){return{x:(1-t)*e.x+t*i.x,y:(1-t)*e.y+t*i.y}}function wn(e,i,t=[!1,!1,!1]){let[n,o,r]=t,s={x:0,y:0};return{path:`M ${e.x},${e.y}L ${i.x},${i.y}`,points:{start:n?Pe(e,i,.15):s,center:o?Pe(e,i,.5):s,end:r?Pe(e,i,.85):s}}}function Sn(e,i,t,n,o=[!1,!1,!1]){let r={x:e.x-i.x,y:e.y-i.y},s=gs(e,t,r),a=gs(i,n,r),l=`M${e.x},${e.y} C${s.x},${s.y} ${a.x},${a.y} ${i.x},${i.y}`;return mc(l,e,i,s,a,o)}function gs(e,i,t){let n={x:0,y:0};switch(i){case"top":n.y=1;break;case"bottom":n.y=-1;break;case"right":n.x=1;break;case"left":n.x=-1;break}let o={x:t.x*Math.abs(n.x),y:t.y*Math.abs(n.y)},s=.25*25*Math.sqrt(Math.abs(o.x+o.y));return{x:e.x+n.x*s,y:e.y-n.y*s}}function mc(e,i,t,n,o,r){let[s,a,l]=r,u={x:0,y:0};return{path:e,points:{start:s?no(i,t,n,o,.1):u,center:a?no(i,t,n,o,.5):u,end:l?no(i,t,n,o,.9):u}}}function no(e,i,t,n,o){let r=Pe(e,t,o),s=Pe(t,n,o),a=Pe(n,i,o);return Pe(Pe(r,s,o),Pe(s,a,o),o)}var xs={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1}};function gc(e,i){let t=Math.abs(i.x-e.x)/2,n=i.x<e.x?i.x+t:i.x-t,o=Math.abs(i.y-e.y)/2,r=i.y<e.y?i.y+o:i.y-o;return[n,r,t,o]}var xc=({source:e,sourcePosition:i="bottom",target:t})=>i==="left"||i==="right"?e.x<t.x?{x:1,y:0}:{x:-1,y:0}:e.y<t.y?{x:0,y:1}:{x:0,y:-1},ys=(e,i)=>Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));function yc({source:e,sourcePosition:i="bottom",target:t,targetPosition:n="top",offset:o}){let r=xs[i],s=xs[n],a={x:e.x+r.x*o,y:e.y+r.y*o},l={x:t.x+s.x*o,y:t.y+s.y*o},u=xc({source:a,sourcePosition:i,target:l}),c=u.x!==0?"x":"y",m=u[c],p=[],y,P,$={x:0,y:0},Z={x:0,y:0},[b,me]=gc(e,t);if(r[c]*s[c]===-1){y=b,P=me;let g=[{x:y,y:a.y},{x:y,y:l.y}],E=[{x:a.x,y:P},{x:l.x,y:P}];r[c]===m?p=c==="x"?g:E:p=c==="x"?E:g}else{let g=[{x:a.x,y:l.y}],E=[{x:l.x,y:a.y}];if(c==="x"?p=r.x===m?E:g:p=r.y===m?g:E,i===n){let ie=Math.abs(e[c]-t[c]);if(ie<=o){let oe=Math.min(o-1,o-ie);r[c]===m?$[c]=(a[c]>e[c]?-1:1)*oe:Z[c]=(l[c]>t[c]?-1:1)*oe}}if(i!==n){let ie=c==="x"?"y":"x",oe=r[c]===s[ie],yt=a[ie]>l[ie],vt=a[ie]<l[ie];(r[c]===1&&(!oe&&yt||oe&&vt)||r[c]!==1&&(!oe&&vt||oe&&yt))&&(p=c==="x"?g:E)}let V={x:a.x+$.x,y:a.y+$.y},j={x:l.x+Z.x,y:l.y+Z.y},ce=Math.max(Math.abs(V.x-p[0].x),Math.abs(j.x-p[0].x)),_e=Math.max(Math.abs(V.y-p[0].y),Math.abs(j.y-p[0].y));ce>=_e?(y=(V.x+j.x)/2,P=p[0].y):(y=p[0].x,P=(V.y+j.y)/2)}return[[e,{x:a.x+$.x,y:a.y+$.y},...p,{x:l.x+Z.x,y:l.y+Z.y},t],y,P]}function vc(e,i,t,n){let o=Math.min(ys(e,i)/2,ys(i,t)/2,n),{x:r,y:s}=i;if(e.x===r&&r===t.x||e.y===s&&s===t.y)return`L${r} ${s}`;if(e.y===s){let u=e.x<t.x?-1:1,c=e.y<t.y?1:-1;return`L ${r+o*u},${s}Q ${r},${s} ${r},${s+o*c}`}let a=e.x<t.x?1:-1,l=e.y<t.y?-1:1;return`L ${r},${s+o*l}Q ${r},${s} ${r+o*a},${s}`}function xt(e,i,t,n,o=5){let[r,s,a]=yc({source:e,sourcePosition:t,target:i,targetPosition:n,offset:20});return{path:r.reduce((u,c,m)=>{let p="";return m>0&&m<r.length-1?p=vc(r[m-1],c,r[m+1],o):p=`${m===0?"M":"L"}${c.x} ${c.y}`,u+=p,u},""),points:{start:{x:s,y:a},center:{x:s,y:a},end:{x:s,y:a}}}}var Ci=class{constructor(i){this.edge=i,this.source=S(void 0),this.target=S(void 0),this.selected=S(!1),this.selected$=X(this.selected),this.detached=v(()=>{let t=this.source(),n=this.target();if(!t||!n)return!0;let o=!1,r=!1;return this.edge.sourceHandle?o=!!t.handles().find(s=>s.rawHandle.id===this.edge.sourceHandle):o=!!t.handles().find(s=>s.rawHandle.type==="source"),this.edge.targetHandle?r=!!n.handles().find(s=>s.rawHandle.id===this.edge.targetHandle):r=!!n.handles().find(s=>s.rawHandle.type==="target"),!o||!r}),this.detached$=X(this.detached),this.path=v(()=>{let t;this.edge.sourceHandle?t=this.source()?.handles().find(o=>o.rawHandle.id===this.edge.sourceHandle):t=this.source()?.handles().find(o=>o.rawHandle.type==="source");let n;if(this.edge.targetHandle?n=this.target()?.handles().find(o=>o.rawHandle.id===this.edge.targetHandle):n=this.target()?.handles().find(o=>o.rawHandle.type==="target"),!t||!n)return{path:"",points:{start:{x:0,y:0},center:{x:0,y:0},end:{x:0,y:0}}};switch(this.curve){case"straight":return wn(t.pointAbsolute(),n.pointAbsolute(),this.usingPoints);case"bezier":return Sn(t.pointAbsolute(),n.pointAbsolute(),t.rawHandle.position,n.rawHandle.position,this.usingPoints);case"smooth-step":return xt(t.pointAbsolute(),n.pointAbsolute(),t.rawHandle.position,n.rawHandle.position);case"step":return xt(t.pointAbsolute(),n.pointAbsolute(),t.rawHandle.position,n.rawHandle.position,0)}}),this.edgeLabels={},this.type=i.type??"default",this.curve=i.curve??"bezier",i.edgeLabels?.start&&(this.edgeLabels.start=new Xt(i.edgeLabels.start)),i.edgeLabels?.center&&(this.edgeLabels.center=new Xt(i.edgeLabels.center)),i.edgeLabels?.end&&(this.edgeLabels.end=new Xt(i.edgeLabels.end)),this.usingPoints=[!!this.edgeLabels.start,!!this.edgeLabels.center,!!this.edgeLabels.end]}};var bn=class{static nodes(i,t){let n=new Map;return t.forEach(o=>n.set(o.node,o)),i.map(o=>n.has(o)?n.get(o):new ms(o))}static edges(i,t){let n=new Map;return t.forEach(o=>n.set(o.edge,o)),i.map(o=>n.has(o)?n.get(o):new Ci(o))}};var _c=25,Tn=(()=>{class e{constructor(){this.entitiesService=h(pe),this.nodesPositionChange$=X(this.entitiesService.nodes).pipe(Ee(t=>ue(...t.map(n=>n.point$.pipe(Ze(1),I(()=>n))))),I(t=>this.entitiesService.nodes().filter(n=>n===t||n.selected()).map(n=>({type:"position",id:n.node.id,point:n.point()})))),this.nodeSizeChange$=X(this.entitiesService.nodes).pipe(Ee(t=>ue(...t.map(n=>n.size$.pipe(Ze(1),I(()=>n))))),I(t=>[{type:"size",id:t.node.id,size:t.size()}])),this.nodeAddChange$=X(this.entitiesService.nodes).pipe(It(),I(([t,n])=>n.filter(o=>!t.includes(o))),de(t=>!!t.length),I(t=>t.map(n=>({type:"add",id:n.node.id})))),this.nodeRemoveChange$=X(this.entitiesService.nodes).pipe(It(),I(([t,n])=>t.filter(o=>!n.includes(o))),de(t=>!!t.length),I(t=>t.map(n=>({type:"remove",id:n.node.id})))),this.nodeSelectedChange$=X(this.entitiesService.nodes).pipe(Ee(t=>ue(...t.map(n=>n.selected$.pipe(Zt(),Ze(1),I(()=>n))))),I(t=>[{type:"select",id:t.node.id,selected:t.selected()}])),this.changes$=ue(this.nodesPositionChange$,this.nodeSizeChange$,this.nodeAddChange$,this.nodeRemoveChange$,this.nodeSelectedChange$).pipe(Ue(Mn,_c))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var Cc=(e,i)=>e.length===i.length&&[...new Set([...e,...i])].every(t=>e.filter(n=>n===t).length===i.filter(n=>n===t).length),En=(()=>{class e{constructor(){this.entitiesService=h(pe),this.edgeDetachedChange$=ue(X(v(()=>{let t=this.entitiesService.nodes();return wt(this.entitiesService.edges).filter(({source:o,target:r})=>!t.includes(o())||!t.includes(r()))})),X(this.entitiesService.edges).pipe(Ee(t=>so(...t.map(n=>n.detached$.pipe(I(()=>n))))),I(t=>t.filter(n=>n.detached())),Ze(2))).pipe(Zt(Cc),de(t=>!!t.length),I(t=>t.map(({edge:n})=>({type:"detached",id:n.id})))),this.edgeAddChange$=X(this.entitiesService.edges).pipe(It(),I(([t,n])=>n.filter(o=>!t.includes(o))),de(t=>!!t.length),I(t=>t.map(({edge:n})=>({type:"add",id:n.id})))),this.edgeRemoveChange$=X(this.entitiesService.edges).pipe(It(),I(([t,n])=>t.filter(o=>!n.includes(o))),de(t=>!!t.length),I(t=>t.map(({edge:n})=>({type:"remove",id:n.id})))),this.edgeSelectChange$=X(this.entitiesService.edges).pipe(Ee(t=>ue(...t.map(n=>n.selected$.pipe(Zt(),Ze(1),I(()=>n))))),I(t=>[{type:"select",id:t.edge.id,selected:t.selected()}])),this.changes$=ue(this.edgeDetachedChange$,this.edgeAddChange$,this.edgeRemoveChange$,this.edgeSelectChange$).pipe(Ue(Mn))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();var vs=(()=>{class e{constructor(){this.nodesChangeService=h(Tn),this.edgesChangeService=h(En),this.onNodesChange=B(this.nodesChangeService.changes$),this.onNodesChangePosition=B(this.nodeChangesOfType("position"),{alias:"onNodesChange.position"}),this.onNodesChangePositionSignle=B(this.singleChange(this.nodeChangesOfType("position")),{alias:"onNodesChange.position.single"}),this.onNodesChangePositionMany=B(this.manyChanges(this.nodeChangesOfType("position")),{alias:"onNodesChange.position.many"}),this.onNodesChangeSize=B(this.nodeChangesOfType("size"),{alias:"onNodesChange.size"}),this.onNodesChangeSizeSingle=B(this.singleChange(this.nodeChangesOfType("size")),{alias:"onNodesChange.size.single"}),this.onNodesChangeSizeMany=B(this.manyChanges(this.nodeChangesOfType("size")),{alias:"onNodesChange.size.many"}),this.onNodesChangeAdd=B(this.nodeChangesOfType("add"),{alias:"onNodesChange.add"}),this.onNodesChangeAddSingle=B(this.singleChange(this.nodeChangesOfType("add")),{alias:"onNodesChange.add.single"}),this.onNodesChangeAddMany=B(this.manyChanges(this.nodeChangesOfType("add")),{alias:"onNodesChange.add.many"}),this.onNodesChangeRemove=B(this.nodeChangesOfType("remove"),{alias:"onNodesChange.remove"}),this.onNodesChangeRemoveSingle=B(this.singleChange(this.nodeChangesOfType("remove")),{alias:"onNodesChange.remove.single"}),this.onNodesChangeRemoveMany=B(this.manyChanges(this.nodeChangesOfType("remove")),{alias:"onNodesChange.remove.many"}),this.onNodesChangeSelect=B(this.nodeChangesOfType("select"),{alias:"onNodesChange.select"}),this.onNodesChangeSelectSingle=B(this.singleChange(this.nodeChangesOfType("select")),{alias:"onNodesChange.select.single"}),this.onNodesChangeSelectMany=B(this.manyChanges(this.nodeChangesOfType("select")),{alias:"onNodesChange.select.many"}),this.onEdgesChange=B(this.edgesChangeService.changes$),this.onNodesChangeDetached=B(this.edgeChangesOfType("detached"),{alias:"onEdgesChange.detached"}),this.onNodesChangeDetachedSingle=B(this.singleChange(this.edgeChangesOfType("detached")),{alias:"onEdgesChange.detached.single"}),this.onNodesChangeDetachedMany=B(this.manyChanges(this.edgeChangesOfType("detached")),{alias:"onEdgesChange.detached.many"}),this.onEdgesChangeAdd=B(this.edgeChangesOfType("add"),{alias:"onEdgesChange.add"}),this.onEdgeChangeAddSingle=B(this.singleChange(this.edgeChangesOfType("add")),{alias:"onEdgesChange.add.single"}),this.onEdgeChangeAddMany=B(this.manyChanges(this.edgeChangesOfType("add")),{alias:"onEdgesChange.add.many"}),this.onEdgeChangeRemove=B(this.edgeChangesOfType("remove"),{alias:"onEdgesChange.remove"}),this.onEdgeChangeRemoveSingle=B(this.singleChange(this.edgeChangesOfType("remove")),{alias:"onEdgesChange.remove.single"}),this.onEdgeChangeRemoveMany=B(this.manyChanges(this.edgeChangesOfType("remove")),{alias:"onEdgesChange.remove.many"}),this.onEdgeChangeSelect=B(this.edgeChangesOfType("select"),{alias:"onEdgesChange.select"}),this.onEdgeChangeSelectSingle=B(this.singleChange(this.edgeChangesOfType("select")),{alias:"onEdgesChange.select.single"}),this.onEdgeChangeSelectMany=B(this.manyChanges(this.edgeChangesOfType("select")),{alias:"onEdgesChange.select.many"})}nodeChangesOfType(t){return this.nodesChangeService.changes$.pipe(I(n=>n.filter(o=>o.type===t)),de(n=>!!n.length))}edgeChangesOfType(t){return this.edgesChangeService.changes$.pipe(I(n=>n.filter(o=>o.type===t)),de(n=>!!n.length))}singleChange(t){return t.pipe(de(n=>n.length===1),I(([n])=>n))}manyChanges(t){return t.pipe(de(n=>n.length>1))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["","changesController",""]],outputs:{onNodesChange:"onNodesChange",onNodesChangePosition:"onNodesChange.position",onNodesChangePositionSignle:"onNodesChange.position.single",onNodesChangePositionMany:"onNodesChange.position.many",onNodesChangeSize:"onNodesChange.size",onNodesChangeSizeSingle:"onNodesChange.size.single",onNodesChangeSizeMany:"onNodesChange.size.many",onNodesChangeAdd:"onNodesChange.add",onNodesChangeAddSingle:"onNodesChange.add.single",onNodesChangeAddMany:"onNodesChange.add.many",onNodesChangeRemove:"onNodesChange.remove",onNodesChangeRemoveSingle:"onNodesChange.remove.single",onNodesChangeRemoveMany:"onNodesChange.remove.many",onNodesChangeSelect:"onNodesChange.select",onNodesChangeSelectSingle:"onNodesChange.select.single",onNodesChangeSelectMany:"onNodesChange.select.many",onEdgesChange:"onEdgesChange",onNodesChangeDetached:"onEdgesChange.detached",onNodesChangeDetachedSingle:"onEdgesChange.detached.single",onNodesChangeDetachedMany:"onEdgesChange.detached.many",onEdgesChangeAdd:"onEdgesChange.add",onEdgeChangeAddSingle:"onEdgesChange.add.single",onEdgeChangeAddMany:"onEdgesChange.add.many",onEdgeChangeRemove:"onEdgesChange.remove",onEdgeChangeRemoveSingle:"onEdgesChange.remove.single",onEdgeChangeRemoveMany:"onEdgesChange.remove.many",onEdgeChangeSelect:"onEdgesChange.select",onEdgeChangeSelectSingle:"onEdgesChange.select.single",onEdgeChangeSelectMany:"onEdgesChange.select.many"},standalone:!0})}}return e})();function io(e){return e.node.type==="default-group"||e.node.type==="template-group"}var zn=(()=>{class e{constructor(){this.flowEntitiesService=h(pe),this.nodes=v(()=>this.flowEntitiesService.nodes().sort((t,n)=>t.renderOrder()-n.renderOrder())),this.groups=v(()=>this.nodes().filter(t=>io(t))),this.nonGroups=v(()=>this.nodes().filter(t=>!io(t))),this.maxOrder=v(()=>Math.max(...this.flowEntitiesService.nodes().map(t=>t.renderOrder())))}pullNode(t){t.renderOrder.set(this.maxOrder()+1),this.flowEntitiesService.nodes().filter(n=>n.parent()===t).forEach(n=>this.pullNode(n))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return e})();function _s(e){return typeof e=="string"?{type:"solid",color:e}:e}Dt();var wi=(()=>{class e{constructor(){this.toolbars=S([]),this.nodeToolbars=v(()=>{let t=new Map;return this.toolbars().forEach(n=>{t.set(n.node,n)}),t})}addToolbar(t){this.toolbars.update(n=>[...n,t])}removeToolbar(t){this.toolbars.update(n=>n.filter(o=>o!==t))}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=W({token:e,factory:e.\u0275fac})}}return Se([it],e.prototype,"addToolbar",null),Se([it],e.prototype,"removeToolbar",null),e})();Dt();var Sc=["edgeLabelWrapper"],bc=["edgeLabel",""];function Tc(e,i){e&1&&be(0)}function Ec(e,i){if(e&1&&(D(),F(0,"foreignObject"),_t(),F(1,"div",1,0),G(3,Tc,1,0,"ng-container",2),L()()),e&2){let t=x(2);M("x",t.edgeLabelPoint().x)("y",t.edgeLabelPoint().y)("width",t.model().size().width)("height",t.model().size().height),w(3),q("ngTemplateOutlet",i)("ngTemplateOutletContext",t.getLabelContext())}}function zc(e,i){if(e&1&&G(0,Ec,4,6,":svg:foreignObject"),e&2){let t,n=x();k(0,(t=n.htmlTemplate())?0:-1,t)}}var Cs=(()=>{class e{constructor(){this.model=H.required(),this.edgeModel=H.required(),this.point=H({x:0,y:0}),this.htmlTemplate=H(),this.edgeLabelWrapperRef=Qe.required("edgeLabelWrapper"),this.edgeLabelPoint=v(()=>{let t=this.point(),{width:n,height:o}=this.model().size();return{x:t.x-n/2,y:t.y-o/2}})}ngAfterViewInit(){let n=this.edgeLabelWrapperRef().nativeElement.clientWidth+2,o=this.edgeLabelWrapperRef().nativeElement.clientHeight+2;this.model().size.set({width:n,height:o})}getLabelContext(){return{$implicit:{edge:this.edgeModel().edge,label:this.model().edgeLabel}}}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["g","edgeLabel",""]],viewQuery:function(n,o){n&1&&Ke(o.edgeLabelWrapperRef,Sc,5),n&2&&Je()},inputs:{model:[O.SignalBased,"model"],edgeModel:[O.SignalBased,"edgeModel"],point:[O.SignalBased,"point"],htmlTemplate:[O.SignalBased,"htmlTemplate"]},standalone:!0,features:[ae],attrs:bc,decls:1,vars:1,consts:[["edgeLabelWrapper",""],[1,"edge-label-wrapper"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,o){n&1&&G(0,zc,1,1),n&2&&k(0,o.model().edgeLabel.type==="html-template"&&o.htmlTemplate()?0:-1)},dependencies:[Ge],styles:[".edge-label-wrapper[_ngcontent-%COMP%]{width:max-content;margin-top:1px;margin-left:1px}"],changeDetection:0})}}return Se([it],e.prototype,"ngAfterViewInit",null),e})();var Nc=["edge",""];function Mc(e,i){if(e&1){let t=ze();D(),F(0,"path",2),J("mousedown",function(){Q(t);let o=x();return K(o.onEdgeMouseDown())}),L()}if(e&2){let t=x();Ft("edge_selected",t.model().selected()),M("d",t.model().path().path)("marker-start",t.markerStartUrl())("marker-end",t.markerEndUrl())}}function kc(e,i){if(e&1&&be(0,3),e&2){let t=x(2);q("ngTemplateOutlet",i)("ngTemplateOutletContext",t.edgeContext)("ngTemplateOutletInjector",t.injector)}}function Oc(e,i){if(e&1&&G(0,kc,1,3,"ng-container",3),e&2){let t,n=x();k(0,(t=n.edgeTemplate())?0:-1,t)}}function Dc(e,i){if(e&1&&(D(),U(0,"g",1)),e&2){let t=x();q("model",i)("point",t.model().path().points.start)("edgeModel",t.model())("htmlTemplate",t.edgeLabelHtmlTemplate())}}function Ic(e,i){if(e&1&&(D(),U(0,"g",1)),e&2){let t=x();q("model",i)("point",t.model().path().points.center)("edgeModel",t.model())("htmlTemplate",t.edgeLabelHtmlTemplate())}}function Hc(e,i){if(e&1&&(D(),U(0,"g",1)),e&2){let t=x();q("model",i)("point",t.model().path().points.end)("edgeModel",t.model())("htmlTemplate",t.edgeLabelHtmlTemplate())}}var ws=(()=>{class e{constructor(){this.injector=h(Ae),this.selectionService=h(gt),this.flowSettingsService=h(ye),this.model=H.required(),this.edgeTemplate=H(),this.edgeLabelHtmlTemplate=H(),this.markerStartUrl=v(()=>{let t=this.model().edge.markers?.start;return t?`url(#${tt(JSON.stringify(t))})`:""}),this.markerEndUrl=v(()=>{let t=this.model().edge.markers?.end;return t?`url(#${tt(JSON.stringify(t))})`:""})}ngOnInit(){this.edgeContext={$implicit:{edge:this.model().edge,path:v(()=>this.model().path().path),markerStart:this.markerStartUrl,markerEnd:this.markerEndUrl,selected:this.model().selected.asReadonly()}}}onEdgeMouseDown(){this.flowSettingsService.entitiesSelectable()&&this.selectionService.select(this.model())}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["g","edge",""]],hostAttrs:[1,"selectable"],inputs:{model:[O.SignalBased,"model"],edgeTemplate:[O.SignalBased,"edgeTemplate"],edgeLabelHtmlTemplate:[O.SignalBased,"edgeLabelHtmlTemplate"]},standalone:!0,features:[ae],attrs:Nc,decls:5,vars:5,consts:[[1,"edge",3,"edge_selected"],["edgeLabel","",3,"model","point","edgeModel","htmlTemplate"],[1,"edge",3,"mousedown"],[3,"ngTemplateOutlet","ngTemplateOutletContext","ngTemplateOutletInjector"]],template:function(n,o){if(n&1&&G(0,Mc,1,5,":svg:path",0)(1,Oc,1,1)(2,Dc,1,4,":svg:g",1)(3,Ic,1,4,":svg:g",1)(4,Hc,1,4,":svg:g",1),n&2){let r,s,a;k(0,o.model().type==="default"?0:-1),w(),k(1,o.model().type==="template"&&o.edgeTemplate()?1:-1),w(),k(2,(r=o.model().edgeLabels.start)?2:-1,r),w(),k(3,(s=o.model().edgeLabels.center)?3:-1,s),w(),k(4,(a=o.model().edgeLabels.end)?4:-1,a)}},dependencies:[Ge,Cs],styles:[".edge[_ngcontent-%COMP%]{fill:none;stroke-width:2;stroke:#b1b1b7}.edge_selected[_ngcontent-%COMP%]{stroke-width:2.5;stroke:#0f4c75}"],changeDetection:0})}}return e})();Dt();function Nn(e,i){return new Ot(t=>{let n=new ResizeObserver(o=>{i.run(()=>t.next(o))});return e.forEach(o=>n.observe(o)),()=>n.disconnect()})}var Ss=(()=>{class e{constructor(){this.handleModel=H.required({alias:"handleSizeController"}),this.handleWrapper=h(se)}ngAfterViewInit(){let t=this.handleWrapper.nativeElement,n=t.getBBox(),o=Rc(t);this.handleModel().size.set({width:n.width+o,height:n.height+o})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["","handleSizeController",""]],inputs:{handleModel:[O.SignalBased,"handleSizeController","handleModel"]},standalone:!0})}}return e})();function Rc(e){let i=e.firstElementChild;if(i){let t=getComputedStyle(i).strokeWidth,n=Number(t.replace("px",""));return isNaN(n)?0:n}return 0}var Pc=["*"],bs=(()=>{class e{constructor(){this.selected=H(!1)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["default-node"]],hostVars:2,hostBindings:function(n,o){n&2&&Ft("selected",o.selected())},inputs:{selected:[O.SignalBased,"selected"]},standalone:!0,features:[ae],ngContentSelectors:Pc,decls:1,vars:0,template:function(n,o){n&1&&(Rn(),Pn(0))},styles:["[_nghost-%COMP%]{border:1.5px solid #1b262c;border-radius:5px;display:flex;align-items:center;justify-content:center;color:#000;background-color:#fff}.selected[_nghost-%COMP%]{border-width:2px}"]})}}return e})();var Fc=["htmlWrapper"],Vc=["node",""],$c=(e,i)=>({node:e,selected:i}),Ts=e=>({$implicit:e}),Ac=(e,i,t,n)=>({node:e,selected:i,width:t,height:n});function Bc(e,i){if(e&1){let t=ze();D(),F(0,"foreignObject",3),J("pointerStart",function(){Q(t);let o=x();return o.pullNode(),K(o.selectNode())}),_t(),F(1,"default-node",4,0),U(3,"div",5)(4,"handle",6)(5,"handle",7),L()()}if(e&2){let t=x();M("width",t.nodeModel().size().width)("height",t.nodeModel().size().height),w(),at("width",t.styleWidth())("height",t.styleHeight())("max-width",t.styleWidth())("max-height",t.styleHeight()),q("selected",t.nodeModel().selected()),w(2),q("outerHTML",t.nodeModel().text(),ho)}}function Lc(e,i){if(e&1){let t=ze();D(),F(0,"foreignObject",3),J("pointerStart",function(){Q(t);let o=x();return K(o.pullNode())}),_t(),F(1,"div",8,0),be(3,9),L()()}if(e&2){let t,n=x();M("width",n.nodeModel().size().width)("height",n.nodeModel().size().height),w(),at("width",n.styleWidth())("height",n.styleHeight()),w(2),q("ngTemplateOutlet",(t=n.nodeTemplate())!==null&&t!==void 0?t:null)("ngTemplateOutletContext",Ei(12,Ts,mo(9,$c,n.nodeModel().node,n.nodeModel().selected)))("ngTemplateOutletInjector",n.injector)}}function jc(e,i){if(e&1){let t=ze();D(),F(0,"foreignObject",3),J("pointerStart",function(){Q(t);let o=x();return K(o.pullNode())}),_t(),F(1,"div",8,0),be(3,10),L()()}if(e&2){let t=x();M("width",t.nodeModel().size().width)("height",t.nodeModel().size().height),w(),at("width",t.styleWidth())("height",t.styleHeight()),w(2),q("ngComponentOutlet",t.nodeModel().node.type)("ngComponentOutletInputs",t.nodeModel().componentTypeInputs)("ngComponentOutletInjector",t.injector)}}function Gc(e,i){if(e&1){let t=ze();D(),F(0,"rect",11),J("pointerStart",function(){Q(t);let o=x();return o.pullNode(),K(o.selectNode())}),L()}if(e&2){let t=x();at("stroke",t.nodeModel().color())("fill",t.nodeModel().color()),Ft("default-group-node_selected",t.nodeModel().selected()),q("resizable",t.nodeModel().resizable())("gap",3)("resizerColor",t.nodeModel().color()),M("width",t.nodeModel().size().width)("height",t.nodeModel().size().height)}}function qc(e,i){if(e&1){let t=ze();D(),F(0,"g",3),J("pointerStart",function(){Q(t);let o=x();return K(o.pullNode())}),be(1,9),L()}if(e&2){let t,n=x();w(),q("ngTemplateOutlet",(t=n.groupNodeTemplate())!==null&&t!==void 0?t:null)("ngTemplateOutletContext",Ei(8,Ts,go(3,Ac,n.nodeModel().node,n.nodeModel().selected,n.nodeModel().width,n.nodeModel().height)))("ngTemplateOutletInjector",n.injector)}}function Wc(e,i){}function Xc(e,i){if(e&1&&G(0,Wc,0,0,"ng-template",12),e&2){let t=x();q("ngTemplateOutlet",t)}}function Yc(e,i){if(e&1&&G(0,Xc,1,1,null,12),e&2){let t=x();k(0,t.nodeModel().resizable()?0:-1)}}function Uc(e,i){if(e&1){let t=ze();D(),F(0,"circle",16),J("pointerStart",function(o){Q(t);let r=x().$implicit,s=x();return K(s.startConnection(o,r))})("pointerEnd",function(){Q(t);let o=x().$implicit,r=x();return K(r.endConnection(o))}),L()}if(e&2){let t=x().$implicit;M("cx",t.offset().x)("cy",t.offset().y)("stroke-width",t.strokeWidth)}}function Zc(e,i){e&1&&(D(),be(0))}function Qc(e,i){if(e&1){let t=ze();D(),F(0,"g",17),J("pointerStart",function(o){Q(t);let r=x().$implicit,s=x();return K(s.startConnection(o,r))})("pointerEnd",function(){Q(t);let o=x().$implicit,r=x();return K(r.endConnection(o))}),G(1,Zc,1,0,"ng-container",18),L()}if(e&2){let t=x().$implicit;q("handleSizeController",t),w(),q("ngTemplateOutlet",t.template)("ngTemplateOutletContext",t.templateContext)}}function Kc(e,i){if(e&1){let t=ze();D(),F(0,"circle",19),J("pointerEnd",function(){Q(t);let o=x().$implicit,r=x();return r.endConnection(o),K(r.resetValidateConnection(o))})("pointerOver",function(){Q(t);let o=x().$implicit,r=x();return K(r.validateConnection(o))})("pointerOut",function(){Q(t);let o=x().$implicit,r=x();return K(r.resetValidateConnection(o))}),L()}if(e&2){let t=x().$implicit,n=x();M("r",n.nodeModel().magnetRadius)("cx",t.offset().x)("cy",t.offset().y)}}function Jc(e,i){if(e&1&&G(0,Uc,1,3,":svg:circle",13)(1,Qc,2,3,":svg:g",14)(2,Kc,1,3,":svg:circle",15),e&2){let t=i.$implicit,n=x();k(0,t.template?-1:0),w(),k(1,t.template?1:-1),w(),k(2,n.showMagnet()?2:-1)}}function eu(e,i){if(e&1&&(D(),F(0,"foreignObject"),_t(),be(1,12),L()),e&2){let t=i;M("width",t.size().width)("height",t.size().height)("transform",t.transform()),w(),q("ngTemplateOutlet",t.template())}}var Es=(()=>{class e{constructor(){this.injector=h(Ae),this.handleService=h(Jt),this.draggableService=h(vi),this.flowStatusService=h(We),this.nodeRenderingService=h(zn),this.flowSettingsService=h(ye),this.selectionService=h(gt),this.hostRef=h(se),this.connectionController=h(_i),this.nodeAccessor=h(St),this.overlaysService=h(wi),this.zone=h(Dn),this.nodeModel=H.required(),this.nodeTemplate=H(),this.groupNodeTemplate=H(),this.htmlWrapperRef=Qe.required("htmlWrapper"),this.showMagnet=v(()=>this.flowStatusService.status().state==="connection-start"||this.flowStatusService.status().state==="connection-validation"),this.styleWidth=v(()=>`${this.nodeModel().size().width}px`),this.styleHeight=v(()=>`${this.nodeModel().size().height}px`),this.toolbar=v(()=>this.overlaysService.nodeToolbars().get(this.nodeModel()))}ngOnInit(){this.nodeAccessor.model.set(this.nodeModel()),this.handleService.node.set(this.nodeModel()),Ce(()=>{this.nodeModel().draggable()?this.draggableService.enable(this.hostRef.nativeElement,this.nodeModel()):this.draggableService.disable(this.hostRef.nativeElement)}),this.nodeModel().handles$.pipe(Ee(t=>Nn(t.map(n=>n.parentReference),this.zone).pipe(I(()=>t))),ee(t=>{t.forEach(n=>n.updateParent())}),he()).subscribe()}ngAfterViewInit(){this.nodeModel().linkDefaultNodeSizeWithModelSize(),(this.nodeModel().node.type==="html-template"||this.nodeModel().isComponentType)&&Nn([this.htmlWrapperRef().nativeElement],this.zone).pipe(ao(null),ee(()=>this.nodeModel().handles().forEach(t=>t.updateParent())),de(()=>!this.nodeModel().resizing()),ee(()=>{let t=this.htmlWrapperRef().nativeElement.clientWidth,n=this.htmlWrapperRef().nativeElement.clientHeight;this.nodeModel().size.set({width:t,height:n})}),he()).subscribe()}ngOnDestroy(){this.draggableService.destroy(this.hostRef.nativeElement)}startConnection(t,n){t.stopPropagation(),this.connectionController.startConnection(n)}validateConnection(t){this.connectionController.validateConnection(t)}resetValidateConnection(t){this.connectionController.resetValidateConnection(t)}endConnection(t){this.connectionController.endConnection(t)}pullNode(){this.nodeRenderingService.pullNode(this.nodeModel())}selectNode(){this.flowSettingsService.entitiesSelectable()&&this.selectionService.select(this.nodeModel())}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["g","node",""]],viewQuery:function(n,o){n&1&&Ke(o.htmlWrapperRef,Fc,5),n&2&&Je()},hostAttrs:[1,"vflow-node"],inputs:{nodeModel:[O.SignalBased,"nodeModel"],nodeTemplate:[O.SignalBased,"nodeTemplate"],groupNodeTemplate:[O.SignalBased,"groupNodeTemplate"]},standalone:!0,features:[Fn([Jt,St]),ae],attrs:Vc,decls:9,vars:7,consts:[["htmlWrapper",""],[1,"selectable"],["rx","5","ry","5",1,"default-group-node",3,"resizable","gap","resizerColor","default-group-node_selected","stroke","fill"],[1,"selectable",3,"pointerStart"],[3,"selected"],[3,"outerHTML"],["type","source","position","right"],["type","target","position","left"],[1,"wrapper"],[3,"ngTemplateOutlet","ngTemplateOutletContext","ngTemplateOutletInjector"],[3,"ngComponentOutlet","ngComponentOutletInputs","ngComponentOutletInjector"],["rx","5","ry","5",1,"default-group-node",3,"pointerStart","resizable","gap","resizerColor"],[3,"ngTemplateOutlet"],["r","5",1,"default-handle"],[3,"handleSizeController"],[1,"magnet"],["r","5",1,"default-handle",3,"pointerStart","pointerEnd"],[3,"pointerStart","pointerEnd","handleSizeController"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"magnet",3,"pointerEnd","pointerOver","pointerOut"]],template:function(n,o){if(n&1&&(G(0,Bc,6,12,":svg:foreignObject",1)(1,Lc,4,14,":svg:foreignObject",1)(2,jc,4,9,":svg:foreignObject",1)(3,Gc,1,11,":svg:rect",2)(4,qc,2,10,":svg:g",1)(5,Yc,1,1),Le(6,Jc,3,3,null,null,Hn),G(8,eu,2,4,":svg:foreignObject")),n&2){let r,s;k(0,o.nodeModel().node.type==="default"?0:-1),w(),k(1,o.nodeModel().node.type==="html-template"&&o.nodeTemplate()?1:-1),w(),k(2,o.nodeModel().isComponentType?2:-1),w(),k(3,o.nodeModel().node.type==="default-group"?3:-1),w(),k(4,o.nodeModel().node.type==="template-group"&&o.groupNodeTemplate()?4:-1),w(),k(5,(r=o.nodeModel().resizerTemplate())?5:-1,r),w(),je(o.nodeModel().handles()),w(2),k(8,(s=o.toolbar())?8:-1,s)}},dependencies:[Bn,bs,To,Ge,_o,bo,Ss],styles:[".magnet[_ngcontent-%COMP%]{opacity:0}.wrapper[_ngcontent-%COMP%]{display:table-cell}.default-group-node[_ngcontent-%COMP%]{stroke-width:1.5px;fill-opacity:.05}.default-group-node_selected[_ngcontent-%COMP%]{stroke-width:2px}.default-handle[_ngcontent-%COMP%]{stroke:#fff;fill:#1b262c}"],changeDetection:0})}}return Se([en],e.prototype,"ngOnInit",null),Se([en],e.prototype,"ngAfterViewInit",null),e})();var tu=["connection",""];function nu(e,i){if(e&1&&(D(),U(0,"path",0)),e&2){let t=x(2);M("d",i)("marker-end",t.markerUrl())("stroke",t.defaultColor)}}function iu(e,i){if(e&1&&G(0,nu,1,3,":svg:path",0),e&2){let t,n=x();k(0,(t=n.path())?0:-1,t)}}function ou(e,i){e&1&&be(0)}function ru(e,i){if(e&1&&G(0,ou,1,0,"ng-container",1),e&2){let t=x(2);q("ngTemplateOutlet",i)("ngTemplateOutletContext",t.getContext())}}function su(e,i){if(e&1&&G(0,ru,1,2,"ng-container"),e&2){let t,n=x();k(0,(t=n.template())?0:-1,t)}}var Ns=(()=>{class e{constructor(){this.model=H.required(),this.template=H(),this.flowStatusService=h(We),this.spacePointContext=h(ut),this.path=v(()=>{let t=this.flowStatusService.status();if(t.state==="connection-start"){let n=t.payload.sourceHandle,o=n.pointAbsolute(),r=n.rawHandle.position,s=this.spacePointContext.svgCurrentSpacePoint(),a=zs(n.rawHandle.position);switch(this.model().curve){case"straight":return wn(o,s).path;case"bezier":return Sn(o,s,r,a).path;case"smooth-step":return xt(o,s,r,a).path;case"step":return xt(o,s,r,a,0).path}}if(t.state==="connection-validation"){let n=t.payload.sourceHandle,o=n.pointAbsolute(),r=n.rawHandle.position,s=t.payload.targetHandle,a=t.payload.valid?s.pointAbsolute():this.spacePointContext.svgCurrentSpacePoint(),l=t.payload.valid?s.rawHandle.position:zs(n.rawHandle.position);switch(this.model().curve){case"straight":return wn(o,a).path;case"bezier":return Sn(o,a,r,l).path;case"smooth-step":return xt(o,a,r,l).path;case"step":return xt(o,a,r,l,0).path}}return null}),this.markerUrl=v(()=>{let t=this.model().settings.marker;return t?`url(#${tt(JSON.stringify(t))})`:""}),this.defaultColor="rgb(177, 177, 183)"}getContext(){return{$implicit:{path:this.path,marker:this.markerUrl}}}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["g","connection",""]],inputs:{model:[O.SignalBased,"model"],template:[O.SignalBased,"template"]},standalone:!0,features:[ae],attrs:tu,decls:2,vars:2,consts:[["fill","none","stroke-width","2"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,o){n&1&&G(0,iu,1,1)(1,su,1,1),n&2&&(k(0,o.model().type==="default"?0:-1),w(),k(1,o.model().type==="template"?1:-1))},dependencies:[Ge],encapsulation:2,changeDetection:0})}}return e})();function zs(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"left":return"right";case"right":return"left"}}function Ms(){return String.fromCharCode(65+Math.floor(Math.random()*26))+Date.now()}var au=["background",""];function lu(e,i){if(e&1&&(D(),F(0,"pattern",0),U(1,"circle"),L(),U(2,"rect",1)),e&2){let t=x();M("id",t.patternId)("x",t.x())("y",t.y())("width",t.scaledGap())("height",t.scaledGap()),w(),M("cx",t.patternSize())("cy",t.patternSize())("r",t.patternSize())("fill",t.patternColor()),w(),M("fill",t.patternUrl)}}function cu(e,i){if(e&1&&(D(),F(0,"pattern",0),U(1,"image"),L(),U(2,"rect",1)),e&2){let t=x(2);M("id",t.patternId)("x",t.imageX())("y",t.imageY())("width",t.scaledImageWidth())("height",t.scaledImageHeight()),w(),M("href",t.bgImageSrc())("width",t.scaledImageWidth())("height",t.scaledImageHeight()),w(),M("fill",t.patternUrl)}}function uu(e,i){if(e&1&&(D(),U(0,"image")),e&2){let t=x(2);M("x",t.imageX())("y",t.imageY())("width",t.scaledImageWidth())("height",t.scaledImageHeight())("href",t.bgImageSrc())}}function du(e,i){if(e&1&&G(0,cu,3,9)(1,uu,1,5,":svg:image"),e&2){let t=x();k(0,t.repeated()?0:-1),w(),k(1,t.repeated()?-1:1)}}var hu="#fff",pu=20,fu=2,ks="rgb(177, 177, 183)",Os=.1,mu=!0,Ds=(()=>{class e{constructor(){this.viewportService=h(nt),this.rootSvg=h(ct).element,this.settingsService=h(ye),this.backgroundSignal=this.settingsService.background,this.scaledGap=v(()=>{let t=this.backgroundSignal();return t.type==="dots"?this.viewportService.readableViewport().zoom*(t.gap??pu):0}),this.x=v(()=>this.viewportService.readableViewport().x%this.scaledGap()),this.y=v(()=>this.viewportService.readableViewport().y%this.scaledGap()),this.patternColor=v(()=>{let t=this.backgroundSignal();return t.type==="dots"?t.color??ks:ks}),this.patternSize=v(()=>{let t=this.backgroundSignal();return t.type==="dots"?this.viewportService.readableViewport().zoom*(t.size??fu)/2:0}),this.bgImageSrc=v(()=>{let t=this.backgroundSignal();return t.type==="image"?t.src:""}),this.imageSize=Ne(X(this.backgroundSignal).pipe(Ee(()=>gu(this.bgImageSrc())),I(t=>({width:t.naturalWidth,height:t.naturalHeight}))),{initialValue:{width:0,height:0}}),this.scaledImageWidth=v(()=>{let t=this.backgroundSignal();if(t.type==="image"){let n=t.fixed?1:this.viewportService.readableViewport().zoom;return this.imageSize().width*n*(t.scale??Os)}return 0}),this.scaledImageHeight=v(()=>{let t=this.backgroundSignal();if(t.type==="image"){let n=t.fixed?1:this.viewportService.readableViewport().zoom;return this.imageSize().height*n*(t.scale??Os)}return 0}),this.imageX=v(()=>{let t=this.backgroundSignal();return t.type==="image"?t.repeat?t.fixed?0:this.viewportService.readableViewport().x%this.scaledImageWidth():t.fixed?0:this.viewportService.readableViewport().x:0}),this.imageY=v(()=>{let t=this.backgroundSignal();return t.type==="image"?t.repeat?t.fixed?0:this.viewportService.readableViewport().y%this.scaledImageHeight():t.fixed?0:this.viewportService.readableViewport().y:0}),this.repeated=v(()=>{let t=this.backgroundSignal();return t.type==="image"&&(t.repeat??mu)}),this.patternId=Ms(),this.patternUrl=`url(#${this.patternId})`,Ce(()=>{let t=this.backgroundSignal();t.type==="dots"&&(this.rootSvg.style.backgroundColor=t.backgroundColor??hu),t.type==="solid"&&(this.rootSvg.style.backgroundColor=t.color)})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["g","background",""]],standalone:!0,features:[ae],attrs:au,decls:2,vars:2,consts:[["patternUnits","userSpaceOnUse"],["x","0","y","0","width","100%","height","100%"]],template:function(n,o){n&1&&G(0,lu,3,10)(1,du,2,2),n&2&&(k(0,o.backgroundSignal().type==="dots"?0:-1),w(),k(1,o.backgroundSignal().type==="image"?1:-1))},encapsulation:2,changeDetection:0})}}return e})();function gu(e){let i=new Image;return i.src=e,new Promise(t=>{i.onload=()=>t(i)})}var xu=["flowDefs",""];function yu(e,i){if(e&1&&(D(),U(0,"polyline",3)),e&2){let t,n,o,r=x().$implicit,s=x();at("stroke",(t=r.value.color)!==null&&t!==void 0?t:s.defaultColor)("stroke-width",(n=r.value.strokeWidth)!==null&&n!==void 0?n:2)("fill",(o=r.value.color)!==null&&o!==void 0?o:s.defaultColor)}}function vu(e,i){if(e&1&&(D(),U(0,"polyline",4)),e&2){let t,n,o=x().$implicit,r=x();at("stroke",(t=o.value.color)!==null&&t!==void 0?t:r.defaultColor)("stroke-width",(n=o.value.strokeWidth)!==null&&n!==void 0?n:2)}}function _u(e,i){if(e&1&&(D(),F(0,"marker",0),G(1,yu,1,6,":svg:polyline",1)(2,vu,1,4,":svg:polyline",2),L()),e&2){let t,n,o,r,s=i.$implicit;M("id",s.key)("markerWidth",(t=s.value.width)!==null&&t!==void 0?t:16.5)("markerHeight",(n=s.value.height)!==null&&n!==void 0?n:16.5)("orient",(o=s.value.orient)!==null&&o!==void 0?o:"auto-start-reverse")("markerUnits",(r=s.value.markerUnits)!==null&&r!==void 0?r:"userSpaceOnUse"),w(),k(1,s.value.type==="arrow-closed"||!s.value.type?1:-1),w(),k(2,s.value.type==="arrow"?2:-1)}}var Is=(()=>{class e{constructor(){this.markers=H.required(),this.defaultColor="rgb(177, 177, 183)"}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["defs","flowDefs",""]],inputs:{markers:[O.SignalBased,"markers"]},standalone:!0,features:[ae],attrs:xu,decls:3,vars:2,consts:[["viewBox","-10 -10 20 20","refX","0","refY","0"],["points","-5,-4 1,0 -5,4 -5,-4",1,"marker__arrow_closed",3,"stroke","stroke-width","fill"],["points","-5,-4 0,0 -5,4",1,"marker__arrow_default",3,"stroke","stroke-width"],["points","-5,-4 1,0 -5,4 -5,-4",1,"marker__arrow_closed"],["points","-5,-4 0,0 -5,4",1,"marker__arrow_default"]],template:function(n,o){n&1&&(Le(0,_u,3,7,":svg:marker",0,Hn),xo(2,"keyvalue")),n&2&&je(yo(2,0,o.markers()))},dependencies:[Co],styles:[".marker__arrow_default[_ngcontent-%COMP%]{stroke-width:1px;stroke-linecap:round;stroke-linejoin:round;fill:none}.marker__arrow_closed[_ngcontent-%COMP%]{stroke-linecap:round;stroke-linejoin:round}"],changeDetection:0})}}return e})();var Hs=(()=>{class e{constructor(){this.host=h(se),this.flowSettingsService=h(ye),this.flowWidth=v(()=>{let t=this.flowSettingsService.view();return t==="auto"?"100%":t[0]}),this.flowHeight=v(()=>{let t=this.flowSettingsService.view();return t==="auto"?"100%":t[1]}),Nn([this.host.nativeElement],h(Dn)).pipe(ee(([t])=>{this.flowSettingsService.computedFlowWidth.set(t.contentRect.width),this.flowSettingsService.computedFlowHeight.set(t.contentRect.height)}),he()).subscribe()}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["svg","flowSizeController",""]],hostVars:2,hostBindings:function(n,o){n&2&&M("width",o.flowWidth())("height",o.flowHeight())},standalone:!0})}}return e})();var Rs=(()=>{class e{constructor(){this.flowStatusService=h(We)}resetConnection(){this.flowStatusService.status().state==="connection-start"&&this.flowStatusService.setIdleStatus()}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275dir=A({type:e,selectors:[["svg","rootSvgContext",""]],hostBindings:function(n,o){n&1&&J("mouseup",function(){return o.resetConnection()},!1,Ti)("touchend",function(){return o.resetConnection()},!1,Ti)},standalone:!0})}}return e})();function Cu(e,i){if(e&1&&(D(),U(0,"g",7)),e&2){let t,n=i.$implicit,o=x(2);q("nodeModel",n)("groupNodeTemplate",(t=o.groupNodeTemplateDirective())==null?null:t.templateRef),M("transform",n.pointTransform())}}function wu(e,i){if(e&1&&(D(),U(0,"g",8)),e&2){let t,n,o=i.$implicit,r=x(2);q("model",o)("edgeTemplate",(t=r.edgeTemplateDirective())==null?null:t.templateRef)("edgeLabelHtmlTemplate",(n=r.edgeLabelHtmlDirective())==null?null:n.templateRef)}}function Su(e,i){if(e&1&&(D(),U(0,"g",9)),e&2){let t,n=i.$implicit,o=x(2);q("nodeModel",n)("nodeTemplate",(t=o.nodeTemplateDirective())==null?null:t.templateRef),M("transform",n.pointTransform())}}function bu(e,i){if(e&1&&(Le(0,Cu,1,3,":svg:g",7,Vt().trackNodes,!0),Le(2,wu,1,3,":svg:g",8,Vt().trackEdges,!0),Le(4,Su,1,3,":svg:g",9,Vt().trackNodes,!0)),e&2){let t=x();je(t.groups()),w(2),je(t.edgeModels()),w(2),je(t.nonGroups())}}function Tu(e,i){if(e&1&&(D(),U(0,"g",8)),e&2){let t,n,o=i.$implicit,r=x(2);q("model",o)("edgeTemplate",(t=r.edgeTemplateDirective())==null?null:t.templateRef)("edgeLabelHtmlTemplate",(n=r.edgeLabelHtmlDirective())==null?null:n.templateRef)}}function Eu(e,i){if(e&1&&(D(),U(0,"g",10)),e&2){let t,n,o=i.$implicit,r=x(2);q("nodeModel",o)("nodeTemplate",(t=r.nodeTemplateDirective())==null?null:t.templateRef)("groupNodeTemplate",(n=r.groupNodeTemplateDirective())==null?null:n.templateRef),M("transform",o.pointTransform())}}function zu(e,i){if(e&1&&(Le(0,Tu,1,3,":svg:g",8,Vt().trackEdges,!0),Le(2,Eu,1,4,":svg:g",10,Vt().trackNodes,!0)),e&2){let t=x();je(t.edgeModels()),w(2),je(t.nodeModels())}}function Nu(e,i){e&1&&(D(),be(0,6)),e&2&&q("ngTemplateOutlet",i.template())}var rC=(()=>{class e{constructor(){this.viewportService=h(nt),this.flowEntitiesService=h(pe),this.nodesChangeService=h(Tn),this.edgesChangeService=h(En),this.nodeRenderingService=h(zn),this.flowSettingsService=h(ye),this.componentEventBusService=h(Kt),this.keyboardService=h(Cn),this.injector=h(Ae),this.optimization=H({detachedGroupsLayer:!1}),this.nodeModels=v(()=>this.nodeRenderingService.nodes()),this.groups=v(()=>this.nodeRenderingService.groups()),this.nonGroups=v(()=>this.nodeRenderingService.nonGroups()),this.edgeModels=v(()=>this.flowEntitiesService.validEdges()),this.onComponentNodeEvent=B(this.componentEventBusService.event$),this.nodeTemplateDirective=Pt(ki),this.groupNodeTemplateDirective=Pt(Oi),this.edgeTemplateDirective=Pt(zi),this.edgeLabelHtmlDirective=Pt(Mi),this.connectionTemplateDirective=Pt(Ni),this.mapContext=Qe(yi),this.spacePointContext=Qe.required(ut),this.viewport=this.viewportService.readableViewport.asReadonly(),this.nodesChange=Ne(this.nodesChangeService.changes$,{initialValue:[]}),this.edgesChange=Ne(this.edgesChangeService.changes$,{initialValue:[]}),this.viewportChange$=X(this.viewportService.readableViewport).pipe(Ze(1)),this.nodesChange$=this.nodesChangeService.changes$,this.edgesChange$=this.edgesChangeService.changes$,this.markers=this.flowEntitiesService.markers,this.minimap=this.flowEntitiesService.minimap}set view(t){this.flowSettingsService.view.set(t)}set minZoom(t){this.flowSettingsService.minZoom.set(t)}set maxZoom(t){this.flowSettingsService.maxZoom.set(t)}set background(t){this.flowSettingsService.background.set(_s(t))}set entitiesSelectable(t){this.flowSettingsService.entitiesSelectable.set(t)}set keyboardShortcuts(t){this.keyboardService.setShortcuts(t)}set connection(t){this.flowEntitiesService.connection.set(t)}get connection(){return this.flowEntitiesService.connection()}set nodes(t){let n=Qt(this.injector,()=>bn.nodes(t,this.flowEntitiesService.nodes()));eo(n,this.flowEntitiesService.edges()),this.flowEntitiesService.nodes.set(n)}set edges(t){let n=Qt(this.injector,()=>bn.edges(t,this.flowEntitiesService.edges()));eo(this.nodeModels(),n),this.flowEntitiesService.edges.set(n)}ngOnInit(){this.setInitialNodesOrder()}viewportTo(t){this.viewportService.writableViewport.set({changeType:"absolute",state:t,duration:0})}zoomTo(t){this.viewportService.writableViewport.set({changeType:"absolute",state:{zoom:t},duration:0})}panTo(t){this.viewportService.writableViewport.set({changeType:"absolute",state:t,duration:0})}fitView(t){this.viewportService.fitView(t)}getNode(t){return this.flowEntitiesService.getNode(t)?.node}getDetachedEdges(){return this.flowEntitiesService.getDetachedEdges().map(t=>t.edge)}documentPointToFlowPoint(t){return this.spacePointContext().documentPointToFlowPoint(t)}trackNodes(t,{node:n}){return n}trackEdges(t,{edge:n}){return n}setInitialNodesOrder(){this.nodeModels().forEach(t=>{switch(t.node.type){case"default-group":case"template-group":this.nodeRenderingService.pullNode(t)}})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=re({type:e,selectors:[["vflow"]],contentQueries:function(n,o,r){n&1&&($t(r,o.nodeTemplateDirective,ki,5),$t(r,o.groupNodeTemplateDirective,Oi,5),$t(r,o.edgeTemplateDirective,zi,5),$t(r,o.edgeLabelHtmlDirective,Mi,5),$t(r,o.connectionTemplateDirective,Ni,5)),n&2&&Je(5)},viewQuery:function(n,o){n&1&&(Ke(o.mapContext,yi,5),Ke(o.spacePointContext,ut,5)),n&2&&Je(2)},inputs:{view:"view",minZoom:"minZoom",maxZoom:"maxZoom",background:"background",optimization:[O.SignalBased,"optimization"],entitiesSelectable:"entitiesSelectable",keyboardShortcuts:"keyboardShortcuts",connection:[O.HasDecoratorInputTransform,"connection","connection",t=>new At(t)],nodes:"nodes",edges:"edges"},outputs:{onComponentNodeEvent:"onComponentNodeEvent"},standalone:!0,features:[Fn([vi,nt,We,pe,Tn,En,zn,gt,ye,Kt,Cn,wi]),fo,po([{directive:_i,outputs:["onConnect","onConnect"]},{directive:vs,outputs:["onNodesChange","onNodesChange","onNodesChange.position","onNodesChange.position","onNodesChange.position.single","onNodesChange.position.single","onNodesChange.position.many","onNodesChange.position.many","onNodesChange.size","onNodesChange.size","onNodesChange.size.single","onNodesChange.size.single","onNodesChange.size.many","onNodesChange.size.many","onNodesChange.add","onNodesChange.add","onNodesChange.add.single","onNodesChange.add.single","onNodesChange.add.many","onNodesChange.add.many","onNodesChange.remove","onNodesChange.remove","onNodesChange.remove.single","onNodesChange.remove.single","onNodesChange.remove.many","onNodesChange.remove.many","onNodesChange.select","onNodesChange.select","onNodesChange.select.single","onNodesChange.select.single","onNodesChange.select.many","onNodesChange.select.many","onEdgesChange","onEdgesChange","onEdgesChange.detached","onEdgesChange.detached","onEdgesChange.detached.single","onEdgesChange.detached.single","onEdgesChange.detached.many","onEdgesChange.detached.many","onEdgesChange.add","onEdgesChange.add","onEdgesChange.add.single","onEdgesChange.add.single","onEdgesChange.add.many","onEdgesChange.add.many","onEdgesChange.remove","onEdgesChange.remove","onEdgesChange.remove.single","onEdgesChange.remove.single","onEdgesChange.remove.many","onEdgesChange.remove.many","onEdgesChange.select","onEdgesChange.select","onEdgesChange.select.single","onEdgesChange.select.single","onEdgesChange.select.many","onEdgesChange.select.many"]}]),ae],decls:9,vars:6,consts:[["flow",""],["rootSvgRef","","rootSvgContext","","rootPointer","","flowSizeController","",1,"root-svg"],["flowDefs","",3,"markers"],["background",""],["mapContext","","spacePointContext",""],["connection","",3,"model","template"],[3,"ngTemplateOutlet"],["node","",3,"nodeModel","groupNodeTemplate"],["edge","",3,"model","edgeTemplate","edgeLabelHtmlTemplate"],["node","",3,"nodeModel","nodeTemplate"],["node","",3,"nodeModel","nodeTemplate","groupNodeTemplate"]],template:function(n,o){if(n&1&&(D(),F(0,"svg",1,0),U(2,"defs",2)(3,"g",3),F(4,"g",4),U(5,"g",5),G(6,bu,6,0)(7,zu,4,0),L(),G(8,Nu,1,1,":svg:ng-container",6),L()),n&2){let r,s;w(2),q("markers",o.markers()),w(3),q("model",o.connection)("template",(r=o.connectionTemplateDirective())==null?null:r.templateRef),w(),k(6,o.optimization().detachedGroupsLayer?6:-1),w(),k(7,o.optimization().detachedGroupsLayer?-1:7),w(),k(8,(s=o.minimap())?8:-1,s)}},dependencies:[ct,Rs,lt,Hs,Is,Ds,yi,ut,Ns,Es,ws,Ge],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]     *{box-sizing:border-box}"],changeDetection:0})}}return e})();export{Tt as a,ci as b,An as c,pe as d,So as e,ye as f,nt as g,gt as h,zi as i,Mi as j,ki as k,Oi as l,St as m,$n as n,rd as o,sd as p,wi as q,ws as r,bs as s,bo as t,To as u,Es as v,rC as w};
